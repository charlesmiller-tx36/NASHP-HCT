<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NASHP Hospital Cost Tool Dashboard (2020-2024)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1" integrity="sha384-jb8JQMbMoBUzgWatfe6COACi2ljcDdZQ2OxczGA3bGNeWe+6DChMTBJemed7ZnvJ" crossorigin="anonymous"></script>
    <style>
        :root {
            --bg-primary: #f0f2f5;
            --bg-card: #ffffff;
            --bg-header: #0f172a;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-on-dark: #f1f5f9;
            --accent: #3b82f6;
            --positive: #10b981;
            --negative: #ef4444;
            --border: #e2e8f0;
            --shadow: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
            --shadow-lg: 0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.04);
            --radius: 12px;
            --gap: 16px;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Inter, Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }
        .dashboard { max-width: 1440px; margin: 0 auto; padding: var(--gap); }
        .dashboard-header {
            background: var(--bg-header);
            color: var(--text-on-dark);
            padding: 24px 28px;
            border-radius: var(--radius);
            margin-bottom: var(--gap);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 16px;
        }
        .header-left h1 { font-size: 22px; font-weight: 700; letter-spacing: -0.3px; margin-bottom: 4px; }
        .header-left p { font-size: 13px; color: #94a3b8; }
        .filters { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
        .filter-group { display: flex; flex-direction: column; gap: 3px; }
        .filter-group label { font-size: 10px; text-transform: uppercase; letter-spacing: 0.8px; color: #94a3b8; font-weight: 600; }
        .filter-group select {
            padding: 6px 28px 6px 10px; border: 1px solid rgba(255,255,255,0.15); border-radius: 6px;
            background: rgba(255,255,255,0.08); color: var(--text-on-dark); font-size: 13px; cursor: pointer;
            outline: none; appearance: none; -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2394a3b8' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 8px center; min-width: 120px;
        }
        .filter-group select:hover { border-color: rgba(255,255,255,0.3); background-color: rgba(255,255,255,0.12); }
        .filter-group select option { background: var(--bg-header); color: var(--text-on-dark); }
        .kpi-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: var(--gap); margin-bottom: var(--gap); }
        .kpi-card {
            background: var(--bg-card); border-radius: var(--radius); padding: 20px 24px;
            box-shadow: var(--shadow); border: 1px solid var(--border); transition: box-shadow 0.2s, transform 0.2s;
        }
        .kpi-card:hover { box-shadow: var(--shadow-lg); transform: translateY(-1px); }
        .kpi-label { font-size: 11px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.8px; font-weight: 600; margin-bottom: 6px; }
        .kpi-value { font-size: 30px; font-weight: 800; color: var(--text-primary); letter-spacing: -0.5px; margin-bottom: 4px; }
        .kpi-sub { font-size: 12px; color: var(--text-secondary); font-weight: 500; }
        .kpi-change { font-size: 12px; font-weight: 600; display: inline-flex; align-items: center; gap: 3px; padding: 2px 8px; border-radius: 20px; }
        .kpi-change.positive { color: var(--positive); background: #ecfdf5; }
        .kpi-change.negative { color: var(--negative); background: #fef2f2; }
        .chart-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(420px, 1fr)); gap: var(--gap); margin-bottom: var(--gap); }
        .chart-row.single { grid-template-columns: 1fr; }
        .chart-container {
            background: var(--bg-card); border-radius: var(--radius); padding: 20px 24px 16px;
            box-shadow: var(--shadow); border: 1px solid var(--border);
        }
        .chart-container h3 { font-size: 14px; font-weight: 700; color: var(--text-primary); margin-bottom: 4px; }
        .chart-subtitle { font-size: 12px; color: var(--text-secondary); margin-bottom: 14px; }
        .chart-container canvas { max-height: 320px; }
        .table-section {
            background: var(--bg-card); border-radius: var(--radius); padding: 20px 24px;
            box-shadow: var(--shadow); border: 1px solid var(--border); overflow-x: auto; margin-bottom: var(--gap);
        }
        .table-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; }
        .table-header h3 { font-size: 14px; font-weight: 700; }
        .table-header .table-count { font-size: 12px; color: var(--text-secondary); }
        .data-table { width: 100%; border-collapse: collapse; font-size: 13px; }
        .data-table thead th {
            text-align: left; padding: 10px 14px; border-bottom: 2px solid var(--border);
            color: var(--text-secondary); font-weight: 600; font-size: 11px; text-transform: uppercase;
            letter-spacing: 0.5px; white-space: nowrap; user-select: none; cursor: pointer;
        }
        .data-table thead th:hover { color: var(--text-primary); background: #f8fafc; }
        .data-table thead th .sort-arrow { margin-left: 4px; opacity: 0.5; }
        .data-table thead th.sorted .sort-arrow { opacity: 1; color: var(--accent); }
        .data-table tbody td { padding: 10px 14px; border-bottom: 1px solid #f1f5f9; }
        .data-table tbody tr:hover { background: #f8fafc; }
        .data-table tbody tr:last-child td { border-bottom: none; }
        td.num { text-align: right; font-variant-numeric: tabular-nums; }
        td.positive-val { color: var(--positive); font-weight: 600; }
        td.negative-val { color: var(--negative); font-weight: 600; }
        .dashboard-footer { text-align: center; padding: 16px; font-size: 12px; color: var(--text-secondary); }
        .dashboard-footer a { color: var(--accent); text-decoration: none; }
        @media (max-width: 900px) {
            .dashboard-header { flex-direction: column; }
            .kpi-row { grid-template-columns: repeat(2, 1fr); }
            .chart-row { grid-template-columns: 1fr; }
        }
        @media (max-width: 500px) {
            .kpi-row { grid-template-columns: 1fr; }
            .filters { flex-direction: column; align-items: stretch; }
        }
        @media print {
            body { background: white; }
            .dashboard { max-width: none; padding: 0; }
            .filters { display: none; }
            .chart-container, .kpi-card, .table-section { box-shadow: none; border: 1px solid #ddd; break-inside: avoid; }
        }
    </style>
</head>
<body>
<div class="dashboard">
    <header class="dashboard-header">
        <div class="header-left">
            <h1>NASHP Hospital Cost Tool Dashboard</h1>
            <p>National Academy for State Health Policy &bull; Medicare Cost Report Data, 2020&ndash;2024</p>
        </div>
        <div class="filters">
            <div class="filter-group"><label>Year</label><select id="filter-year" onchange="dashboard.applyFilters()"><option value="all">All Years</option></select></div>
            <div class="filter-group"><label>State</label><select id="filter-state" onchange="dashboard.applyFilters()"><option value="all">All States</option></select></div>
            <div class="filter-group"><label>Ownership</label><select id="filter-ownership" onchange="dashboard.applyFilters()"><option value="all">All Types</option></select></div>
            <div class="filter-group"><label>Facility</label><select id="filter-facility" onchange="dashboard.applyFilters()"><option value="all">All Facilities</option></select></div>
            <div class="filter-group"><label>Setting</label><select id="filter-urban" onchange="dashboard.applyFilters()"><option value="all">Urban & Rural</option></select></div>
        </div>
    </header>

    <section class="kpi-row">
        <div class="kpi-card"><div class="kpi-label">Hospitals Reporting</div><div class="kpi-value" id="kpi-count">&mdash;</div><div class="kpi-sub" id="kpi-count-sub"></div></div>
        <div class="kpi-card"><div class="kpi-label">Median Net Profit Margin</div><div class="kpi-value" id="kpi-margin">&mdash;</div><div id="kpi-margin-change" class="kpi-change"></div></div>
        <div class="kpi-card"><div class="kpi-label">Hospitals Profitable</div><div class="kpi-value" id="kpi-profitable">&mdash;</div><div id="kpi-profitable-change" class="kpi-change"></div></div>
        <div class="kpi-card"><div class="kpi-label">Total Net Patient Revenue</div><div class="kpi-value" id="kpi-revenue">&mdash;</div><div id="kpi-revenue-change" class="kpi-change"></div></div>
        <div class="kpi-card"><div class="kpi-label">Median Cost-to-Charge Ratio</div><div class="kpi-value" id="kpi-ctc">&mdash;</div><div class="kpi-sub" id="kpi-ctc-sub">Lower = higher markups</div></div>
        <div class="kpi-card"><div class="kpi-label">COVID-19 PHE Funding</div><div class="kpi-value" id="kpi-covid">&mdash;</div><div id="kpi-covid-change" class="kpi-change"></div></div>
    </section>

    <section class="chart-row">
        <div class="chart-container"><h3>Net Profit Margin Trend by Ownership</h3><div class="chart-subtitle">Median margin across all reporting hospitals</div><canvas id="chart-margin-trend"></canvas></div>
        <div class="chart-container"><h3>Payer Profit Margins by Year</h3><div class="chart-subtitle">Median operating margin by payer type</div><canvas id="chart-payer-margins"></canvas></div>
    </section>
    <section class="chart-row">
        <div class="chart-container"><h3>Hospital Count by Ownership Type</h3><div class="chart-subtitle">Distribution across for-profit, non-profit, and governmental</div><canvas id="chart-ownership-mix"></canvas></div>
        <div class="chart-container"><h3>Direct Patient Care Labor Hourly Rate</h3><div class="chart-subtitle">Median hourly rate trend by ownership type</div><canvas id="chart-labor-rate"></canvas></div>
    </section>
    <section class="chart-row single">
        <div class="chart-container"><h3 id="state-chart-title">State Profitability Ranking (2024)</h3><div class="chart-subtitle">Median net profit margin by state &mdash; latest available year</div><canvas id="chart-state-rank" style="max-height:500px"></canvas></div>
    </section>

    <section class="table-section">
        <div class="table-header"><h3>State-Level Detail</h3><span class="table-count" id="table-count"></span></div>
        <div id="table-container"></div>
    </section>

    <footer class="dashboard-footer">
        Data source: NASHP Hospital Cost Tool Dataset (December 2025 release) &bull;
        Healthcare Cost Report Information System &bull;
        <a href="https://tool.nashp.org" target="_blank">tool.nashp.org</a>
    </footer>
</div>
<script>

var D = {"yearly": [{"year": 2020, "count": 4537, "medianNetProfitMargin": 0.058868, "medianOperatingProfitMargin": 0.095702, "medianCostToChargeRatio": 0.29791, "medianCommercialMargin": 0.359712, "medianMedicareMargin": -0.0024, "medianMedicaidMargin": -0.239958, "totalNetRevenue": 967398508292.0, "totalNetIncome": 70626307177.0, "medianLaborHourlyRate": 43.211819, "pctPositiveMargin": 72.6, "medianChargesAsPctCosts": 3.356718, "totalCovidFunding": 37793796170.0}, {"year": 2021, "count": 4508, "medianNetProfitMargin": 0.116324, "medianOperatingProfitMargin": 0.130668, "medianCostToChargeRatio": 0.28397, "medianCommercialMargin": 0.38109, "medianMedicareMargin": 0.010611, "medianMedicaidMargin": -0.186706, "totalNetRevenue": 1079558908185.0, "totalNetIncome": 132564144310.0, "medianLaborHourlyRate": 46.611413, "pctPositiveMargin": 82.7, "medianChargesAsPctCosts": 3.521495, "totalCovidFunding": 21598945826.0}, {"year": 2022, "count": 4505, "medianNetProfitMargin": 0.020665, "medianOperatingProfitMargin": 0.10606, "medianCostToChargeRatio": 0.29006, "medianCommercialMargin": 0.351805, "medianMedicareMargin": -0.000825, "medianMedicaidMargin": -0.209148, "totalNetRevenue": 1136856320629.0, "totalNetIncome": 29145436119.0, "medianLaborHourlyRate": 52.093248, "pctPositiveMargin": 57.9, "medianChargesAsPctCosts": 3.447562, "totalCovidFunding": 10144205413.0}, {"year": 2023, "count": 4490, "medianNetProfitMargin": 0.037948, "medianOperatingProfitMargin": 0.113634, "medianCostToChargeRatio": 0.278499, "medianCommercialMargin": 0.354011, "medianMedicareMargin": -0.007236, "medianMedicaidMargin": -0.185071, "totalNetRevenue": 1218044860616.0, "totalNetIncome": 89179135037.0, "medianLaborHourlyRate": 52.872159, "pctPositiveMargin": 64.5, "medianChargesAsPctCosts": 3.590676, "totalCovidFunding": 3040186076.0}, {"year": 2024, "count": 4468, "medianNetProfitMargin": 0.056238, "medianOperatingProfitMargin": 0.136817, "medianCostToChargeRatio": 0.271179, "medianCommercialMargin": 0.354912, "medianMedicareMargin": -0.004665, "medianMedicaidMargin": -0.086016, "totalNetRevenue": 1322625606061.0, "totalNetIncome": 119470529885.0, "medianLaborHourlyRate": 53.034578, "pctPositiveMargin": 69.8, "medianChargesAsPctCosts": 3.687608, "totalCovidFunding": 1325576326.0}], "yearOwnership": [{"year": 2020, "ownership": "For-Profit", "count": 817, "medianNetProfitMargin": 0.086988, "medianOperatingProfitMargin": 0.170169, "medianCostToChargeRatio": 0.161734, "medianCommercialMargin": 0.447776, "medianMedicareMargin": 0.02663, "medianMedicaidMargin": -0.176808, "medianLaborHourlyRate": 41.754483}, {"year": 2020, "ownership": "Governmental", "count": 1016, "medianNetProfitMargin": 0.046679, "medianOperatingProfitMargin": -0.008803, "medianCostToChargeRatio": 0.515488, "medianCommercialMargin": 0.204574, "medianMedicareMargin": -0.000886, "medianMedicaidMargin": -0.174305, "medianLaborHourlyRate": 40.28666}, {"year": 2020, "ownership": "Non-Profit", "count": 2704, "medianNetProfitMargin": 0.058087, "medianOperatingProfitMargin": 0.104617, "medianCostToChargeRatio": 0.300191, "medianCommercialMargin": 0.373002, "medianMedicareMargin": -0.012089, "medianMedicaidMargin": -0.273812, "medianLaborHourlyRate": 44.315424}, {"year": 2021, "ownership": "For-Profit", "count": 796, "medianNetProfitMargin": 0.124936, "medianOperatingProfitMargin": 0.192793, "medianCostToChargeRatio": 0.156863, "medianCommercialMargin": 0.4483, "medianMedicareMargin": 0.050098, "medianMedicaidMargin": -0.133784, "medianLaborHourlyRate": 44.815294}, {"year": 2021, "ownership": "Governmental", "count": 1006, "medianNetProfitMargin": 0.131163, "medianOperatingProfitMargin": 0.016324, "medianCostToChargeRatio": 0.505131, "medianCommercialMargin": 0.214323, "medianMedicareMargin": 0.010451, "medianMedicaidMargin": -0.135789, "medianLaborHourlyRate": 42.624445}, {"year": 2021, "ownership": "Non-Profit", "count": 2706, "medianNetProfitMargin": 0.11078, "medianOperatingProfitMargin": 0.144933, "medianCostToChargeRatio": 0.284863, "medianCommercialMargin": 0.398139, "medianMedicareMargin": 0.008257, "medianMedicaidMargin": -0.209736, "medianLaborHourlyRate": 48.078458}, {"year": 2022, "ownership": "For-Profit", "count": 777, "medianNetProfitMargin": 0.083097, "medianOperatingProfitMargin": 0.167265, "medianCostToChargeRatio": 0.159752, "medianCommercialMargin": 0.428753, "medianMedicareMargin": 0.021596, "medianMedicaidMargin": -0.149487, "medianLaborHourlyRate": 48.892082}, {"year": 2022, "ownership": "Governmental", "count": 998, "medianNetProfitMargin": 0.0273, "medianOperatingProfitMargin": 0.002797, "medianCostToChargeRatio": 0.508061, "medianCommercialMargin": 0.201488, "medianMedicareMargin": 0.003373, "medianMedicaidMargin": -0.144393, "medianLaborHourlyRate": 48.620762}, {"year": 2022, "ownership": "Non-Profit", "count": 2730, "medianNetProfitMargin": 0.006676, "medianOperatingProfitMargin": 0.118243, "medianCostToChargeRatio": 0.292615, "medianCommercialMargin": 0.371656, "medianMedicareMargin": -0.014947, "medianMedicaidMargin": -0.238932, "medianLaborHourlyRate": 54.43068}, {"year": 2023, "ownership": "For-Profit", "count": 760, "medianNetProfitMargin": 0.07593, "medianOperatingProfitMargin": 0.182932, "medianCostToChargeRatio": 0.152681, "medianCommercialMargin": 0.418371, "medianMedicareMargin": 0.020463, "medianMedicaidMargin": -0.105338, "medianLaborHourlyRate": 49.852084}, {"year": 2023, "ownership": "Governmental", "count": 995, "medianNetProfitMargin": 0.016281, "medianOperatingProfitMargin": -0.000596, "medianCostToChargeRatio": 0.501314, "medianCommercialMargin": 0.178628, "medianMedicareMargin": -0.005932, "medianMedicaidMargin": -0.12392, "medianLaborHourlyRate": 48.991904}, {"year": 2023, "ownership": "Non-Profit", "count": 2735, "medianNetProfitMargin": 0.037696, "medianOperatingProfitMargin": 0.125429, "medianCostToChargeRatio": 0.277541, "medianCommercialMargin": 0.374605, "medianMedicareMargin": -0.014867, "medianMedicaidMargin": -0.220003, "medianLaborHourlyRate": 54.509483}, {"year": 2024, "ownership": "For-Profit", "count": 729, "medianNetProfitMargin": 0.090545, "medianOperatingProfitMargin": 0.202358, "medianCostToChargeRatio": 0.149683, "medianCommercialMargin": 0.417485, "medianMedicareMargin": 0.020802, "medianMedicaidMargin": 0.007478, "medianLaborHourlyRate": 50.150078}, {"year": 2024, "ownership": "Governmental", "count": 991, "medianNetProfitMargin": 0.031613, "medianOperatingProfitMargin": 0.029118, "medianCostToChargeRatio": 0.493977, "medianCommercialMargin": 0.182387, "medianMedicareMargin": -0.005376, "medianMedicaidMargin": -0.023711, "medianLaborHourlyRate": 49.632256}, {"year": 2024, "ownership": "Non-Profit", "count": 2748, "medianNetProfitMargin": 0.059618, "medianOperatingProfitMargin": 0.148505, "medianCostToChargeRatio": 0.267102, "medianCommercialMargin": 0.385777, "medianMedicareMargin": -0.006103, "medianMedicaidMargin": -0.119757, "medianLaborHourlyRate": 54.788618}], "yearState": [{"year": 2020, "state": "AK", "count": 21, "medianNetProfitMargin": 0.093595, "medianOperatingProfitMargin": 0.109821, "medianCostToChargeRatio": 0.604233, "medianCommercialMargin": 0.453033, "medianMedicareMargin": -0.005153, "medianMedicaidMargin": -0.022953, "totalNetRevenue": 2213296258.0, "medianLaborHourlyRate": 58.977296}, {"year": 2020, "state": "AL", "count": 87, "medianNetProfitMargin": 0.043169, "medianOperatingProfitMargin": 0.077341, "medianCostToChargeRatio": 0.254814, "medianCommercialMargin": 0.229121, "medianMedicareMargin": 0.084633, "medianMedicaidMargin": 0.265839, "totalNetRevenue": 11609870590.0, "medianLaborHourlyRate": 33.337977}, {"year": 2020, "state": "AR", "count": 73, "medianNetProfitMargin": 0.083802, "medianOperatingProfitMargin": 0.062153, "medianCostToChargeRatio": 0.298951, "medianCommercialMargin": 0.249722, "medianMedicareMargin": 0.038184, "medianMedicaidMargin": -0.087629, "totalNetRevenue": 6988858697.0, "medianLaborHourlyRate": 37.93386}, {"year": 2020, "state": "AZ", "count": 78, "medianNetProfitMargin": 0.070635, "medianOperatingProfitMargin": 0.104045, "medianCostToChargeRatio": 0.180881, "medianCommercialMargin": 0.448922, "medianMedicareMargin": -0.013386, "medianMedicaidMargin": -0.463762, "totalNetRevenue": 17014042409.0, "medianLaborHourlyRate": 46.141748}, {"year": 2020, "state": "CA", "count": 323, "medianNetProfitMargin": 0.054678, "medianOperatingProfitMargin": 0.098219, "medianCostToChargeRatio": 0.219105, "medianCommercialMargin": 0.485673, "medianMedicareMargin": -0.11275, "medianMedicaidMargin": -0.241058, "totalNetRevenue": 103018217628.0, "medianLaborHourlyRate": 65.191291}, {"year": 2020, "state": "CO", "count": 82, "medianNetProfitMargin": 0.089319, "medianOperatingProfitMargin": 0.162725, "medianCostToChargeRatio": 0.309822, "medianCommercialMargin": 0.443096, "medianMedicareMargin": -0.02815, "medianMedicaidMargin": -0.35029, "totalNetRevenue": 16737488603.0, "medianLaborHourlyRate": 49.007907}, {"year": 2020, "state": "CT", "count": 28, "medianNetProfitMargin": 0.020487, "medianOperatingProfitMargin": 0.073444, "medianCostToChargeRatio": 0.328143, "medianCommercialMargin": 0.329115, "medianMedicareMargin": -0.092995, "medianMedicaidMargin": -0.524716, "totalNetRevenue": 11829282586.0, "medianLaborHourlyRate": 54.282806}, {"year": 2020, "state": "DC", "count": 6, "medianNetProfitMargin": 0.03199, "medianOperatingProfitMargin": 0.173801, "medianCostToChargeRatio": 0.274331, "medianCommercialMargin": 0.298648, "medianMedicareMargin": -0.194913, "medianMedicaidMargin": 0.255164, "totalNetRevenue": 3516948899.0, "medianLaborHourlyRate": 50.616376}, {"year": 2020, "state": "DE", "count": 6, "medianNetProfitMargin": 0.076606, "medianOperatingProfitMargin": 0.103126, "medianCostToChargeRatio": 0.332938, "medianCommercialMargin": 0.389478, "medianMedicareMargin": -0.291249, "medianMedicaidMargin": 0.074934, "totalNetRevenue": 3051723127.0, "medianLaborHourlyRate": 50.476294}, {"year": 2020, "state": "FL", "count": 180, "medianNetProfitMargin": 0.082399, "medianOperatingProfitMargin": 0.132212, "medianCostToChargeRatio": 0.155518, "medianCommercialMargin": 0.493971, "medianMedicareMargin": 0.012992, "medianMedicaidMargin": -0.85755, "totalNetRevenue": 56899236337.0, "medianLaborHourlyRate": 41.940443}, {"year": 2020, "state": "GA", "count": 130, "medianNetProfitMargin": 0.043297, "medianOperatingProfitMargin": 0.101664, "medianCostToChargeRatio": 0.244666, "medianCommercialMargin": 0.371465, "medianMedicareMargin": 0.026283, "medianMedicaidMargin": -0.047223, "totalNetRevenue": 25570726722.0, "medianLaborHourlyRate": 40.917932}, {"year": 2020, "state": "HI", "count": 21, "medianNetProfitMargin": 0.034573, "medianOperatingProfitMargin": -0.147047, "medianCostToChargeRatio": 0.462604, "medianCommercialMargin": -0.076062, "medianMedicareMargin": -0.045009, "medianMedicaidMargin": -0.307708, "totalNetRevenue": 2724333359.0, "medianLaborHourlyRate": 62.867458}, {"year": 2020, "state": "IA", "count": 115, "medianNetProfitMargin": 0.052706, "medianOperatingProfitMargin": 0.051092, "medianCostToChargeRatio": 0.573139, "medianCommercialMargin": 0.234847, "medianMedicareMargin": -0.001963, "medianMedicaidMargin": -0.258819, "totalNetRevenue": 9248078636.0, "medianLaborHourlyRate": 39.42799}, {"year": 2020, "state": "ID", "count": 43, "medianNetProfitMargin": 0.061995, "medianOperatingProfitMargin": 0.13067, "medianCostToChargeRatio": 0.535634, "medianCommercialMargin": 0.371406, "medianMedicareMargin": 0.00079, "medianMedicaidMargin": -0.22312, "totalNetRevenue": 5882501838.0, "medianLaborHourlyRate": 41.684484}, {"year": 2020, "state": "IL", "count": 174, "medianNetProfitMargin": 0.039838, "medianOperatingProfitMargin": 0.087534, "medianCostToChargeRatio": 0.272396, "medianCommercialMargin": 0.393446, "medianMedicareMargin": -0.034987, "medianMedicaidMargin": -0.412704, "totalNetRevenue": 38920111886.0, "medianLaborHourlyRate": 44.662668}, {"year": 2020, "state": "IN", "count": 116, "medianNetProfitMargin": 0.11564, "medianOperatingProfitMargin": 0.186133, "medianCostToChargeRatio": 0.254885, "medianCommercialMargin": 0.495129, "medianMedicareMargin": -0.056117, "medianMedicaidMargin": -0.55016, "totalNetRevenue": 25101930728.0, "medianLaborHourlyRate": 43.11913}, {"year": 2020, "state": "KS", "count": 132, "medianNetProfitMargin": 0.044639, "medianOperatingProfitMargin": -0.04916, "medianCostToChargeRatio": 0.614796, "medianCommercialMargin": 0.071648, "medianMedicareMargin": -0.001268, "medianMedicaidMargin": -0.560784, "totalNetRevenue": 9494034013.0, "medianLaborHourlyRate": 39.057213}, {"year": 2020, "state": "KY", "count": 91, "medianNetProfitMargin": 0.104143, "medianOperatingProfitMargin": 0.130266, "medianCostToChargeRatio": 0.267875, "medianCommercialMargin": 0.42686, "medianMedicareMargin": 0.011683, "medianMedicaidMargin": -0.040464, "totalNetRevenue": 14596890852.0, "medianLaborHourlyRate": 38.686259}, {"year": 2020, "state": "LA", "count": 113, "medianNetProfitMargin": 0.06234, "medianOperatingProfitMargin": 0.031696, "medianCostToChargeRatio": 0.288179, "medianCommercialMargin": 0.222728, "medianMedicareMargin": 0.000812, "medianMedicaidMargin": -0.091965, "totalNetRevenue": 13464341485.0, "medianLaborHourlyRate": 36.747933}, {"year": 2020, "state": "MA", "count": 59, "medianNetProfitMargin": 0.041358, "medianOperatingProfitMargin": 0.01854, "medianCostToChargeRatio": 0.420776, "medianCommercialMargin": 0.188829, "medianMedicareMargin": -0.058605, "medianMedicaidMargin": -0.209061, "totalNetRevenue": 25107456375.0, "medianLaborHourlyRate": 52.117005}, {"year": 2020, "state": "MD", "count": 46, "medianNetProfitMargin": 0.022758, "medianOperatingProfitMargin": 0.154874, "medianCostToChargeRatio": 0.722457, "medianCommercialMargin": 0.21641, "medianMedicareMargin": 0.140861, "medianMedicaidMargin": 0.208081, "totalNetRevenue": 15589977882.0, "medianLaborHourlyRate": 43.829046}, {"year": 2020, "state": "ME", "count": 33, "medianNetProfitMargin": -0.000946, "medianOperatingProfitMargin": 0.07562, "medianCostToChargeRatio": 0.472071, "medianCommercialMargin": 0.350463, "medianMedicareMargin": -0.025821, "medianMedicaidMargin": -0.224321, "totalNetRevenue": 5439294613.0, "medianLaborHourlyRate": 39.978524}, {"year": 2020, "state": "MI", "count": 130, "medianNetProfitMargin": 0.048894, "medianOperatingProfitMargin": 0.095066, "medianCostToChargeRatio": 0.337525, "medianCommercialMargin": 0.298544, "medianMedicareMargin": 0.014247, "medianMedicaidMargin": -0.317583, "totalNetRevenue": 32112782999.0, "medianLaborHourlyRate": 41.536168}, {"year": 2020, "state": "MN", "count": 126, "medianNetProfitMargin": 0.057336, "medianOperatingProfitMargin": 0.103992, "medianCostToChargeRatio": 0.556499, "medianCommercialMargin": 0.318864, "medianMedicareMargin": -0.005292, "medianMedicaidMargin": -0.480349, "totalNetRevenue": 19596204583.0, "medianLaborHourlyRate": 52.779259}, {"year": 2020, "state": "MO", "count": 103, "medianNetProfitMargin": 0.032238, "medianOperatingProfitMargin": 0.108802, "medianCostToChargeRatio": 0.300605, "medianCommercialMargin": 0.356016, "medianMedicareMargin": 5.6e-05, "medianMedicaidMargin": -0.059595, "totalNetRevenue": 21484978243.0, "medianLaborHourlyRate": 42.189085}, {"year": 2020, "state": "MS", "count": 91, "medianNetProfitMargin": 0.023471, "medianOperatingProfitMargin": 0.014259, "medianCostToChargeRatio": 0.342177, "medianCommercialMargin": 0.166596, "medianMedicareMargin": 0.017888, "medianMedicaidMargin": 0.18698, "totalNetRevenue": 7627708524.0, "medianLaborHourlyRate": 36.861129}, {"year": 2020, "state": "MT", "count": 62, "medianNetProfitMargin": 0.078077, "medianOperatingProfitMargin": 0.035413, "medianCostToChargeRatio": 0.759883, "medianCommercialMargin": 0.228815, "medianMedicareMargin": -0.004163, "medianMedicaidMargin": 0.028161, "totalNetRevenue": 4306344007.0, "medianLaborHourlyRate": 40.199994}, {"year": 2020, "state": "NC", "count": 103, "medianNetProfitMargin": 0.065424, "medianOperatingProfitMargin": 0.186632, "medianCostToChargeRatio": 0.254274, "medianCommercialMargin": 0.471745, "medianMedicareMargin": 0.019682, "medianMedicaidMargin": -0.004656, "totalNetRevenue": 31440457692.0, "medianLaborHourlyRate": 40.470785}, {"year": 2020, "state": "ND", "count": 44, "medianNetProfitMargin": 0.032669, "medianOperatingProfitMargin": 0.053335, "medianCostToChargeRatio": 0.807014, "medianCommercialMargin": 0.173225, "medianMedicareMargin": 0.000746, "medianMedicaidMargin": -0.185184, "totalNetRevenue": 4827661985.0, "medianLaborHourlyRate": 39.67096}, {"year": 2020, "state": "NE", "count": 88, "medianNetProfitMargin": 0.080709, "medianOperatingProfitMargin": 0.038411, "medianCostToChargeRatio": 0.713695, "medianCommercialMargin": 0.195609, "medianMedicareMargin": -0.005151, "medianMedicaidMargin": -0.316055, "totalNetRevenue": 6663513538.0, "medianLaborHourlyRate": 45.26152}, {"year": 2020, "state": "NH", "count": 26, "medianNetProfitMargin": 0.051141, "medianOperatingProfitMargin": 0.09352, "medianCostToChargeRatio": 0.418616, "medianCommercialMargin": 0.345296, "medianMedicareMargin": -0.038187, "medianMedicaidMargin": -0.313151, "totalNetRevenue": 4933352417.0, "medianLaborHourlyRate": 45.871417}, {"year": 2020, "state": "NJ", "count": 63, "medianNetProfitMargin": 0.017817, "medianOperatingProfitMargin": 0.040983, "medianCostToChargeRatio": 0.195146, "medianCommercialMargin": 0.373816, "medianMedicareMargin": -0.1144, "medianMedicaidMargin": -0.346161, "totalNetRevenue": 22926799127.0, "medianLaborHourlyRate": 49.665092}, {"year": 2020, "state": "NM", "count": 42, "medianNetProfitMargin": 0.102576, "medianOperatingProfitMargin": 0.171807, "medianCostToChargeRatio": 0.310584, "medianCommercialMargin": 0.532975, "medianMedicareMargin": -0.091877, "medianMedicaidMargin": 0.03428, "totalNetRevenue": 5675049202.0, "medianLaborHourlyRate": 43.466694}, {"year": 2020, "state": "NV", "count": 34, "medianNetProfitMargin": 0.100156, "medianOperatingProfitMargin": 0.090578, "medianCostToChargeRatio": 0.195085, "medianCommercialMargin": 0.38454, "medianMedicareMargin": 0.020523, "medianMedicaidMargin": -0.59606, "totalNetRevenue": 6575360384.0, "medianLaborHourlyRate": 54.593026}, {"year": 2020, "state": "NY", "count": 160, "medianNetProfitMargin": 0.013758, "medianOperatingProfitMargin": -0.038884, "medianCostToChargeRatio": 0.37296, "medianCommercialMargin": 0.258392, "medianMedicareMargin": -0.090454, "medianMedicaidMargin": -0.461057, "totalNetRevenue": 72876202055.0, "medianLaborHourlyRate": 53.689323}, {"year": 2020, "state": "OH", "count": 159, "medianNetProfitMargin": 0.080237, "medianOperatingProfitMargin": 0.124243, "medianCostToChargeRatio": 0.271284, "medianCommercialMargin": 0.435438, "medianMedicareMargin": -0.00545, "medianMedicaidMargin": -0.443943, "totalNetRevenue": 41330008697.0, "medianLaborHourlyRate": 41.013937}, {"year": 2020, "state": "OK", "count": 118, "medianNetProfitMargin": 0.036254, "medianOperatingProfitMargin": 0.065131, "medianCostToChargeRatio": 0.250743, "medianCommercialMargin": 0.361741, "medianMedicareMargin": 0.006756, "medianMedicaidMargin": -0.136183, "totalNetRevenue": 10926603084.0, "medianLaborHourlyRate": 38.618094}, {"year": 2020, "state": "OR", "count": 59, "medianNetProfitMargin": 0.074006, "medianOperatingProfitMargin": 0.146308, "medianCostToChargeRatio": 0.409518, "medianCommercialMargin": 0.469538, "medianMedicareMargin": -0.013575, "medianMedicaidMargin": -0.284137, "totalNetRevenue": 12750568955.0, "medianLaborHourlyRate": 58.334531}, {"year": 2020, "state": "PA", "count": 160, "medianNetProfitMargin": 0.012484, "medianOperatingProfitMargin": 0.113559, "medianCostToChargeRatio": 0.228155, "medianCommercialMargin": 0.304966, "medianMedicareMargin": -0.04422, "medianMedicaidMargin": -0.33641, "totalNetRevenue": 42649207820.0, "medianLaborHourlyRate": 42.146008}, {"year": 2020, "state": "RI", "count": 10, "medianNetProfitMargin": 0.004538, "medianOperatingProfitMargin": 0.04377, "medianCostToChargeRatio": 0.322538, "medianCommercialMargin": 0.245173, "medianMedicareMargin": -0.153625, "medianMedicaidMargin": -0.373431, "totalNetRevenue": 3130454979.0, "medianLaborHourlyRate": 45.443618}, {"year": 2020, "state": "SC", "count": 58, "medianNetProfitMargin": 0.048878, "medianOperatingProfitMargin": 0.175111, "medianCostToChargeRatio": 0.220175, "medianCommercialMargin": 0.484687, "medianMedicareMargin": -0.001126, "medianMedicaidMargin": 0.081975, "totalNetRevenue": 15038598352.0, "medianLaborHourlyRate": 41.589532}, {"year": 2020, "state": "SD", "count": 57, "medianNetProfitMargin": 0.089475, "medianOperatingProfitMargin": 0.13952, "medianCostToChargeRatio": 0.519624, "medianCommercialMargin": 0.381148, "medianMedicareMargin": -0.001192, "medianMedicaidMargin": -0.254024, "totalNetRevenue": 4602309416.0, "medianLaborHourlyRate": 38.925419}, {"year": 2020, "state": "TN", "count": 98, "medianNetProfitMargin": 0.03178, "medianOperatingProfitMargin": 0.10127, "medianCostToChargeRatio": 0.20374, "medianCommercialMargin": 0.350269, "medianMedicareMargin": 0.082762, "medianMedicaidMargin": -0.253525, "totalNetRevenue": 19501312989.0, "medianLaborHourlyRate": 35.760078}, {"year": 2020, "state": "TX", "count": 366, "medianNetProfitMargin": 0.09309, "medianOperatingProfitMargin": 0.067091, "medianCostToChargeRatio": 0.226243, "medianCommercialMargin": 0.307171, "medianMedicareMargin": 0.005465, "medianMedicaidMargin": 0.181433, "totalNetRevenue": 65555141477.0, "medianLaborHourlyRate": 44.008683}, {"year": 2020, "state": "UT", "count": 45, "medianNetProfitMargin": 0.147493, "medianOperatingProfitMargin": 0.284507, "medianCostToChargeRatio": 0.318862, "medianCommercialMargin": 0.457647, "medianMedicareMargin": -0.00018, "medianMedicaidMargin": 0.248226, "totalNetRevenue": 8476219265.0, "medianLaborHourlyRate": 43.370424}, {"year": 2020, "state": "VA", "count": 80, "medianNetProfitMargin": 0.090371, "medianOperatingProfitMargin": 0.172648, "medianCostToChargeRatio": 0.233741, "medianCommercialMargin": 0.445885, "medianMedicareMargin": -0.040762, "medianMedicaidMargin": -0.101715, "totalNetRevenue": 22687479324.0, "medianLaborHourlyRate": 43.538149}, {"year": 2020, "state": "VT", "count": 14, "medianNetProfitMargin": 0.049936, "medianOperatingProfitMargin": 0.037753, "medianCostToChargeRatio": 0.486614, "medianCommercialMargin": 0.305378, "medianMedicareMargin": 0.000739, "medianMedicaidMargin": -0.754956, "totalNetRevenue": 2095729473.0, "medianLaborHourlyRate": 43.611671}, {"year": 2020, "state": "WA", "count": 87, "medianNetProfitMargin": 0.033729, "medianOperatingProfitMargin": 0.092984, "medianCostToChargeRatio": 0.357239, "medianCommercialMargin": 0.398874, "medianMedicareMargin": -0.017259, "medianMedicaidMargin": -0.388373, "totalNetRevenue": 21757277097.0, "medianLaborHourlyRate": 56.291239}, {"year": 2020, "state": "WI", "count": 123, "medianNetProfitMargin": 0.083518, "medianOperatingProfitMargin": 0.187472, "medianCostToChargeRatio": 0.392377, "medianCommercialMargin": 0.462988, "medianMedicareMargin": -0.003805, "medianMedicaidMargin": -0.575321, "totalNetRevenue": 23254790645.0, "medianLaborHourlyRate": 46.17838}, {"year": 2020, "state": "WV", "count": 48, "medianNetProfitMargin": 0.04386, "medianOperatingProfitMargin": 0.068773, "medianCostToChargeRatio": 0.355658, "medianCommercialMargin": 0.408829, "medianMedicareMargin": 0.006383, "medianMedicaidMargin": -0.290557, "totalNetRevenue": 6795946858.0, "medianLaborHourlyRate": 36.684324}, {"year": 2020, "state": "WY", "count": 26, "medianNetProfitMargin": 0.054515, "medianOperatingProfitMargin": 0.18377, "medianCostToChargeRatio": 0.572013, "medianCommercialMargin": 0.389302, "medianMedicareMargin": -0.007663, "medianMedicaidMargin": -0.411996, "totalNetRevenue": 1781801582.0, "medianLaborHourlyRate": 46.157784}, {"year": 2021, "state": "AK", "count": 21, "medianNetProfitMargin": 0.188236, "medianOperatingProfitMargin": 0.161973, "medianCostToChargeRatio": 0.592845, "medianCommercialMargin": 0.437806, "medianMedicareMargin": 0.008177, "medianMedicaidMargin": -0.03654, "totalNetRevenue": 2471886839.0, "medianLaborHourlyRate": 64.553353}, {"year": 2021, "state": "AL", "count": 87, "medianNetProfitMargin": 0.081428, "medianOperatingProfitMargin": 0.08176, "medianCostToChargeRatio": 0.263491, "medianCommercialMargin": 0.116816, "medianMedicareMargin": 0.06563, "medianMedicaidMargin": 0.249993, "totalNetRevenue": 13100840161.0, "medianLaborHourlyRate": 36.117554}, {"year": 2021, "state": "AR", "count": 74, "medianNetProfitMargin": 0.123847, "medianOperatingProfitMargin": 0.09067, "medianCostToChargeRatio": 0.294469, "medianCommercialMargin": 0.190019, "medianMedicareMargin": 0.028892, "medianMedicaidMargin": -0.031119, "totalNetRevenue": 7904073354.0, "medianLaborHourlyRate": 40.561249}, {"year": 2021, "state": "AZ", "count": 79, "medianNetProfitMargin": 0.089763, "medianOperatingProfitMargin": 0.122161, "medianCostToChargeRatio": 0.185772, "medianCommercialMargin": 0.427209, "medianMedicareMargin": -0.048072, "medianMedicaidMargin": -0.36481, "totalNetRevenue": 19639544151.0, "medianLaborHourlyRate": 51.641271}, {"year": 2021, "state": "CA", "count": 321, "medianNetProfitMargin": 0.059651, "medianOperatingProfitMargin": 0.130318, "medianCostToChargeRatio": 0.212588, "medianCommercialMargin": 0.491445, "medianMedicareMargin": -0.080604, "medianMedicaidMargin": -0.197859, "totalNetRevenue": 108572931687.0, "medianLaborHourlyRate": 69.155736}, {"year": 2021, "state": "CO", "count": 82, "medianNetProfitMargin": 0.138689, "medianOperatingProfitMargin": 0.208125, "medianCostToChargeRatio": 0.28378, "medianCommercialMargin": 0.494329, "medianMedicareMargin": -0.004884, "medianMedicaidMargin": -0.462655, "totalNetRevenue": 18176924340.0, "medianLaborHourlyRate": 51.190344}, {"year": 2021, "state": "CT", "count": 28, "medianNetProfitMargin": 0.082279, "medianOperatingProfitMargin": 0.093431, "medianCostToChargeRatio": 0.30324, "medianCommercialMargin": 0.38732, "medianMedicareMargin": -0.025571, "medianMedicaidMargin": -0.566785, "totalNetRevenue": 13287520456.0, "medianLaborHourlyRate": 54.957437}, {"year": 2021, "state": "DC", "count": 6, "medianNetProfitMargin": 0.10782, "medianOperatingProfitMargin": 0.145921, "medianCostToChargeRatio": 0.297787, "medianCommercialMargin": 0.297493, "medianMedicareMargin": -0.148826, "medianMedicaidMargin": 0.253393, "totalNetRevenue": 3889983178.0, "medianLaborHourlyRate": 51.519006}, {"year": 2021, "state": "DE", "count": 6, "medianNetProfitMargin": 0.174437, "medianOperatingProfitMargin": 0.13161, "medianCostToChargeRatio": 0.318039, "medianCommercialMargin": 0.41134, "medianMedicareMargin": -0.239659, "medianMedicaidMargin": -0.110055, "totalNetRevenue": 3474611638.0, "medianLaborHourlyRate": 51.961543}, {"year": 2021, "state": "FL", "count": 176, "medianNetProfitMargin": 0.138247, "medianOperatingProfitMargin": 0.168262, "medianCostToChargeRatio": 0.15365, "medianCommercialMargin": 0.49006, "medianMedicareMargin": 0.026016, "medianMedicaidMargin": -0.863505, "totalNetRevenue": 66162012262.0, "medianLaborHourlyRate": 47.118703}, {"year": 2021, "state": "GA", "count": 129, "medianNetProfitMargin": 0.136209, "medianOperatingProfitMargin": 0.119053, "medianCostToChargeRatio": 0.248179, "medianCommercialMargin": 0.367987, "medianMedicareMargin": 0.028733, "medianMedicaidMargin": -0.022884, "totalNetRevenue": 30176711365.0, "medianLaborHourlyRate": 43.938123}, {"year": 2021, "state": "HI", "count": 21, "medianNetProfitMargin": 0.146046, "medianOperatingProfitMargin": -0.030904, "medianCostToChargeRatio": 0.464138, "medianCommercialMargin": 0.088426, "medianMedicareMargin": -0.027915, "medianMedicaidMargin": -0.225544, "totalNetRevenue": 2918897037.0, "medianLaborHourlyRate": 64.318348}, {"year": 2021, "state": "IA", "count": 115, "medianNetProfitMargin": 0.145167, "medianOperatingProfitMargin": 0.079589, "medianCostToChargeRatio": 0.556473, "medianCommercialMargin": 0.259941, "medianMedicareMargin": 0.010488, "medianMedicaidMargin": -0.188249, "totalNetRevenue": 10236102027.0, "medianLaborHourlyRate": 41.416006}, {"year": 2021, "state": "ID", "count": 43, "medianNetProfitMargin": 0.154524, "medianOperatingProfitMargin": 0.154608, "medianCostToChargeRatio": 0.499742, "medianCommercialMargin": 0.385537, "medianMedicareMargin": 0.013693, "medianMedicaidMargin": -0.194515, "totalNetRevenue": 6786044533.0, "medianLaborHourlyRate": 42.736374}, {"year": 2021, "state": "IL", "count": 171, "medianNetProfitMargin": 0.120624, "medianOperatingProfitMargin": 0.148743, "medianCostToChargeRatio": 0.250277, "medianCommercialMargin": 0.44017, "medianMedicareMargin": -0.005686, "medianMedicaidMargin": -0.312272, "totalNetRevenue": 42219275687.0, "medianLaborHourlyRate": 47.120026}, {"year": 2021, "state": "IN", "count": 117, "medianNetProfitMargin": 0.166075, "medianOperatingProfitMargin": 0.221898, "medianCostToChargeRatio": 0.238622, "medianCommercialMargin": 0.526203, "medianMedicareMargin": -0.017168, "medianMedicaidMargin": -0.303526, "totalNetRevenue": 28416191295.0, "medianLaborHourlyRate": 47.436709}, {"year": 2021, "state": "KS", "count": 130, "medianNetProfitMargin": 0.148206, "medianOperatingProfitMargin": -0.011807, "medianCostToChargeRatio": 0.61187, "medianCommercialMargin": 0.116993, "medianMedicareMargin": 0.007522, "medianMedicaidMargin": -0.503115, "totalNetRevenue": 10163722508.0, "medianLaborHourlyRate": 42.295323}, {"year": 2021, "state": "KY", "count": 90, "medianNetProfitMargin": 0.131921, "medianOperatingProfitMargin": 0.161758, "medianCostToChargeRatio": 0.259077, "medianCommercialMargin": 0.352742, "medianMedicareMargin": 0.02237, "medianMedicaidMargin": 0.148806, "totalNetRevenue": 17037921098.0, "medianLaborHourlyRate": 41.977332}, {"year": 2021, "state": "LA", "count": 114, "medianNetProfitMargin": 0.128814, "medianOperatingProfitMargin": 0.036501, "medianCostToChargeRatio": 0.307973, "medianCommercialMargin": 0.244605, "medianMedicareMargin": -0.007458, "medianMedicaidMargin": -0.103817, "totalNetRevenue": 14988157108.0, "medianLaborHourlyRate": 38.837932}, {"year": 2021, "state": "MA", "count": 59, "medianNetProfitMargin": 0.05777, "medianOperatingProfitMargin": 0.081019, "medianCostToChargeRatio": 0.403128, "medianCommercialMargin": 0.212457, "medianMedicareMargin": -0.005706, "medianMedicaidMargin": -0.201233, "totalNetRevenue": 28521145442.0, "medianLaborHourlyRate": 53.661121}, {"year": 2021, "state": "MD", "count": 45, "medianNetProfitMargin": 0.098697, "medianOperatingProfitMargin": 0.189019, "medianCostToChargeRatio": 0.713219, "medianCommercialMargin": 0.177449, "medianMedicareMargin": 0.189126, "medianMedicaidMargin": 0.183689, "totalNetRevenue": 16562725575.0, "medianLaborHourlyRate": 47.623108}, {"year": 2021, "state": "ME", "count": 33, "medianNetProfitMargin": 0.084527, "medianOperatingProfitMargin": 0.137166, "medianCostToChargeRatio": 0.449679, "medianCommercialMargin": 0.368519, "medianMedicareMargin": 0.011515, "medianMedicaidMargin": -0.147409, "totalNetRevenue": 6201286759.0, "medianLaborHourlyRate": 43.008585}, {"year": 2021, "state": "MI", "count": 129, "medianNetProfitMargin": 0.098642, "medianOperatingProfitMargin": 0.135469, "medianCostToChargeRatio": 0.31934, "medianCommercialMargin": 0.329924, "medianMedicareMargin": 0.041001, "medianMedicaidMargin": -0.216192, "totalNetRevenue": 37164102731.0, "medianLaborHourlyRate": 44.031965}, {"year": 2021, "state": "MN", "count": 125, "medianNetProfitMargin": 0.119745, "medianOperatingProfitMargin": 0.142449, "medianCostToChargeRatio": 0.504818, "medianCommercialMargin": 0.345639, "medianMedicareMargin": 0.00706, "medianMedicaidMargin": -0.338409, "totalNetRevenue": 22001507276.0, "medianLaborHourlyRate": 55.741604}, {"year": 2021, "state": "MO", "count": 102, "medianNetProfitMargin": 0.11204, "medianOperatingProfitMargin": 0.14275, "medianCostToChargeRatio": 0.284573, "medianCommercialMargin": 0.373728, "medianMedicareMargin": 0.010615, "medianMedicaidMargin": -0.058373, "totalNetRevenue": 23155117115.0, "medianLaborHourlyRate": 44.910171}, {"year": 2021, "state": "MS", "count": 91, "medianNetProfitMargin": 0.084967, "medianOperatingProfitMargin": 0.047098, "medianCostToChargeRatio": 0.334581, "medianCommercialMargin": 0.167233, "medianMedicareMargin": 0.026755, "medianMedicaidMargin": 0.188239, "totalNetRevenue": 8271729083.0, "medianLaborHourlyRate": 38.847798}, {"year": 2021, "state": "MT", "count": 61, "medianNetProfitMargin": 0.224418, "medianOperatingProfitMargin": 0.087437, "medianCostToChargeRatio": 0.729467, "medianCommercialMargin": 0.271027, "medianMedicareMargin": 0.009901, "medianMedicaidMargin": 0.060444, "totalNetRevenue": 4862222650.0, "medianLaborHourlyRate": 43.210173}, {"year": 2021, "state": "NC", "count": 103, "medianNetProfitMargin": 0.11836, "medianOperatingProfitMargin": 0.206146, "medianCostToChargeRatio": 0.245431, "medianCommercialMargin": 0.479937, "medianMedicareMargin": 0.034058, "medianMedicaidMargin": 0.055256, "totalNetRevenue": 35091848648.0, "medianLaborHourlyRate": 43.616764}, {"year": 2021, "state": "ND", "count": 44, "medianNetProfitMargin": 0.141427, "medianOperatingProfitMargin": 0.07018, "medianCostToChargeRatio": 0.772548, "medianCommercialMargin": 0.178536, "medianMedicareMargin": 0.014077, "medianMedicaidMargin": -0.14548, "totalNetRevenue": 4492022858.0, "medianLaborHourlyRate": 47.463344}, {"year": 2021, "state": "NE", "count": 88, "medianNetProfitMargin": 0.210503, "medianOperatingProfitMargin": 0.076295, "medianCostToChargeRatio": 0.664095, "medianCommercialMargin": 0.248627, "medianMedicareMargin": 0.009119, "medianMedicaidMargin": -0.252485, "totalNetRevenue": 7287266625.0, "medianLaborHourlyRate": 49.748046}, {"year": 2021, "state": "NH", "count": 26, "medianNetProfitMargin": 0.189519, "medianOperatingProfitMargin": 0.15202, "medianCostToChargeRatio": 0.38532, "medianCommercialMargin": 0.378853, "medianMedicareMargin": -0.038994, "medianMedicaidMargin": -0.189749, "totalNetRevenue": 5559821174.0, "medianLaborHourlyRate": 48.864243}, {"year": 2021, "state": "NJ", "count": 63, "medianNetProfitMargin": 0.022918, "medianOperatingProfitMargin": 0.121005, "medianCostToChargeRatio": 0.183108, "medianCommercialMargin": 0.425717, "medianMedicareMargin": -0.062833, "medianMedicaidMargin": -0.244636, "totalNetRevenue": 25043024888.0, "medianLaborHourlyRate": 53.282825}, {"year": 2021, "state": "NM", "count": 43, "medianNetProfitMargin": 0.169361, "medianOperatingProfitMargin": 0.164145, "medianCostToChargeRatio": 0.312494, "medianCommercialMargin": 0.542274, "medianMedicareMargin": -0.120008, "medianMedicaidMargin": -0.077475, "totalNetRevenue": 6125641166.0, "medianLaborHourlyRate": 46.404544}, {"year": 2021, "state": "NV", "count": 34, "medianNetProfitMargin": 0.107904, "medianOperatingProfitMargin": 0.106026, "medianCostToChargeRatio": 0.196377, "medianCommercialMargin": 0.388237, "medianMedicareMargin": 0.024581, "medianMedicaidMargin": -0.646194, "totalNetRevenue": 7411006250.0, "medianLaborHourlyRate": 58.947593}, {"year": 2021, "state": "NY", "count": 157, "medianNetProfitMargin": 0.032446, "medianOperatingProfitMargin": 0.045124, "medianCostToChargeRatio": 0.343053, "medianCommercialMargin": 0.349951, "medianMedicareMargin": -0.027511, "medianMedicaidMargin": -0.432598, "totalNetRevenue": 82490816783.0, "medianLaborHourlyRate": 56.512513}, {"year": 2021, "state": "OH", "count": 156, "medianNetProfitMargin": 0.131345, "medianOperatingProfitMargin": 0.178443, "medianCostToChargeRatio": 0.254263, "medianCommercialMargin": 0.46273, "medianMedicareMargin": 0.024227, "medianMedicaidMargin": -0.270455, "totalNetRevenue": 47444979308.0, "medianLaborHourlyRate": 43.826887}, {"year": 2021, "state": "OK", "count": 119, "medianNetProfitMargin": 0.101037, "medianOperatingProfitMargin": 0.054903, "medianCostToChargeRatio": 0.265331, "medianCommercialMargin": 0.344881, "medianMedicareMargin": 0.019939, "medianMedicaidMargin": -0.126529, "totalNetRevenue": 12424973176.0, "medianLaborHourlyRate": 40.669706}, {"year": 2021, "state": "OR", "count": 58, "medianNetProfitMargin": 0.107543, "medianOperatingProfitMargin": 0.15797, "medianCostToChargeRatio": 0.406953, "medianCommercialMargin": 0.467941, "medianMedicareMargin": -0.00106, "medianMedicaidMargin": -0.232602, "totalNetRevenue": 13744108622.0, "medianLaborHourlyRate": 61.401309}, {"year": 2021, "state": "PA", "count": 157, "medianNetProfitMargin": 0.104655, "medianOperatingProfitMargin": 0.155802, "medianCostToChargeRatio": 0.221383, "medianCommercialMargin": 0.336972, "medianMedicareMargin": 0.005634, "medianMedicaidMargin": -0.236274, "totalNetRevenue": 47495651608.0, "medianLaborHourlyRate": 43.899785}, {"year": 2021, "state": "RI", "count": 10, "medianNetProfitMargin": 0.060261, "medianOperatingProfitMargin": 0.048798, "medianCostToChargeRatio": 0.302524, "medianCommercialMargin": 0.223473, "medianMedicareMargin": -0.08343, "medianMedicaidMargin": -0.201339, "totalNetRevenue": 3385707395.0, "medianLaborHourlyRate": 48.860142}, {"year": 2021, "state": "SC", "count": 57, "medianNetProfitMargin": 0.132664, "medianOperatingProfitMargin": 0.212417, "medianCostToChargeRatio": 0.216378, "medianCommercialMargin": 0.5265, "medianMedicareMargin": 0.007953, "medianMedicaidMargin": 0.000117, "totalNetRevenue": 16753569551.0, "medianLaborHourlyRate": 44.228737}, {"year": 2021, "state": "SD", "count": 57, "medianNetProfitMargin": 0.224447, "medianOperatingProfitMargin": 0.151565, "medianCostToChargeRatio": 0.491138, "medianCommercialMargin": 0.380805, "medianMedicareMargin": 0.010584, "medianMedicaidMargin": -0.158611, "totalNetRevenue": 5225357938.0, "medianLaborHourlyRate": 41.347528}, {"year": 2021, "state": "TN", "count": 95, "medianNetProfitMargin": 0.081185, "medianOperatingProfitMargin": 0.139232, "medianCostToChargeRatio": 0.195471, "medianCommercialMargin": 0.315112, "medianMedicareMargin": 0.113578, "medianMedicaidMargin": -0.187684, "totalNetRevenue": 21790770043.0, "medianLaborHourlyRate": 38.806734}, {"year": 2021, "state": "TX", "count": 364, "medianNetProfitMargin": 0.129172, "medianOperatingProfitMargin": 0.091171, "medianCostToChargeRatio": 0.225103, "medianCommercialMargin": 0.324693, "medianMedicareMargin": 0.021279, "medianMedicaidMargin": 0.156073, "totalNetRevenue": 74381985098.0, "medianLaborHourlyRate": 47.191535}, {"year": 2021, "state": "UT", "count": 46, "medianNetProfitMargin": 0.173473, "medianOperatingProfitMargin": 0.317897, "medianCostToChargeRatio": 0.303492, "medianCommercialMargin": 0.487585, "medianMedicareMargin": 0.015991, "medianMedicaidMargin": 0.237948, "totalNetRevenue": 9957336458.0, "medianLaborHourlyRate": 47.68313}, {"year": 2021, "state": "VA", "count": 80, "medianNetProfitMargin": 0.135008, "medianOperatingProfitMargin": 0.200104, "medianCostToChargeRatio": 0.228107, "medianCommercialMargin": 0.462317, "medianMedicareMargin": -0.034187, "medianMedicaidMargin": 0.025144, "totalNetRevenue": 25610249166.0, "medianLaborHourlyRate": 46.126768}, {"year": 2021, "state": "VT", "count": 14, "medianNetProfitMargin": 0.130109, "medianOperatingProfitMargin": 0.087382, "medianCostToChargeRatio": 0.441865, "medianCommercialMargin": 0.363124, "medianMedicareMargin": 0.006152, "medianMedicaidMargin": -0.277539, "totalNetRevenue": 2398790126.0, "medianLaborHourlyRate": 45.343337}, {"year": 2021, "state": "WA", "count": 87, "medianNetProfitMargin": 0.08447, "medianOperatingProfitMargin": 0.113065, "medianCostToChargeRatio": 0.322631, "medianCommercialMargin": 0.416815, "medianMedicareMargin": -0.008876, "medianMedicaidMargin": -0.435183, "totalNetRevenue": 24663590621.0, "medianLaborHourlyRate": 60.834046}, {"year": 2021, "state": "WI", "count": 124, "medianNetProfitMargin": 0.163373, "medianOperatingProfitMargin": 0.227698, "medianCostToChargeRatio": 0.362639, "medianCommercialMargin": 0.489401, "medianMedicareMargin": 0.010237, "medianMedicaidMargin": -0.532497, "totalNetRevenue": 24653969707.0, "medianLaborHourlyRate": 47.667792}, {"year": 2021, "state": "WV", "count": 45, "medianNetProfitMargin": 0.119706, "medianOperatingProfitMargin": 0.19102, "medianCostToChargeRatio": 0.345449, "medianCommercialMargin": 0.459392, "medianMedicareMargin": 0.017272, "medianMedicaidMargin": -0.135675, "totalNetRevenue": 7828662474.0, "medianLaborHourlyRate": 37.625003}, {"year": 2021, "state": "WY", "count": 26, "medianNetProfitMargin": 0.116846, "medianOperatingProfitMargin": 0.16471, "medianCostToChargeRatio": 0.573826, "medianCommercialMargin": 0.393432, "medianMedicareMargin": 0.00356, "medianMedicaidMargin": -0.495913, "totalNetRevenue": 1934571147.0, "medianLaborHourlyRate": 49.035639}, {"year": 2022, "state": "AK", "count": 21, "medianNetProfitMargin": 0.067337, "medianOperatingProfitMargin": 0.101895, "medianCostToChargeRatio": 0.594919, "medianCommercialMargin": 0.497538, "medianMedicareMargin": 0.001747, "medianMedicaidMargin": -0.108701, "totalNetRevenue": 2594919572.0, "medianLaborHourlyRate": 65.493204}, {"year": 2022, "state": "AL", "count": 86, "medianNetProfitMargin": 0.0025, "medianOperatingProfitMargin": 0.01956, "medianCostToChargeRatio": 0.27654, "medianCommercialMargin": 0.05658, "medianMedicareMargin": 0.031627, "medianMedicaidMargin": 0.260719, "totalNetRevenue": 13082781401.0, "medianLaborHourlyRate": 40.09607}, {"year": 2022, "state": "AR", "count": 74, "medianNetProfitMargin": 0.012183, "medianOperatingProfitMargin": 0.047067, "medianCostToChargeRatio": 0.305271, "medianCommercialMargin": 0.169978, "medianMedicareMargin": 0.022223, "medianMedicaidMargin": -0.023775, "totalNetRevenue": 8196360915.0, "medianLaborHourlyRate": 48.334849}, {"year": 2022, "state": "AZ", "count": 80, "medianNetProfitMargin": 0.021075, "medianOperatingProfitMargin": 0.107426, "medianCostToChargeRatio": 0.184743, "medianCommercialMargin": 0.443655, "medianMedicareMargin": -0.037995, "medianMedicaidMargin": -0.190951, "totalNetRevenue": 23077098525.0, "medianLaborHourlyRate": 55.516929}, {"year": 2022, "state": "CA", "count": 320, "medianNetProfitMargin": 0.00302, "medianOperatingProfitMargin": 0.107008, "medianCostToChargeRatio": 0.217253, "medianCommercialMargin": 0.472772, "medianMedicareMargin": -0.112229, "medianMedicaidMargin": -0.260849, "totalNetRevenue": 116147494593.0, "medianLaborHourlyRate": 73.736724}, {"year": 2022, "state": "CO", "count": 82, "medianNetProfitMargin": 0.006928, "medianOperatingProfitMargin": 0.163018, "medianCostToChargeRatio": 0.283793, "medianCommercialMargin": 0.452029, "medianMedicareMargin": -0.061103, "medianMedicaidMargin": -0.446655, "totalNetRevenue": 18066191802.0, "medianLaborHourlyRate": 58.051866}, {"year": 2022, "state": "CT", "count": 28, "medianNetProfitMargin": 0.004138, "medianOperatingProfitMargin": 0.091529, "medianCostToChargeRatio": 0.29239, "medianCommercialMargin": 0.371679, "medianMedicareMargin": -0.100849, "medianMedicaidMargin": -0.498386, "totalNetRevenue": 14055270740.0, "medianLaborHourlyRate": 60.424926}, {"year": 2022, "state": "DC", "count": 6, "medianNetProfitMargin": 0.005146, "medianOperatingProfitMargin": 0.116754, "medianCostToChargeRatio": 0.298985, "medianCommercialMargin": 0.272267, "medianMedicareMargin": -0.140364, "medianMedicaidMargin": 0.155432, "totalNetRevenue": 4115830916.0, "medianLaborHourlyRate": 60.11531}, {"year": 2022, "state": "DE", "count": 6, "medianNetProfitMargin": -0.048996, "medianOperatingProfitMargin": 0.119739, "medianCostToChargeRatio": 0.314909, "medianCommercialMargin": 0.40376, "medianMedicareMargin": -0.21292, "medianMedicaidMargin": -0.187404, "totalNetRevenue": 3721686751.0, "medianLaborHourlyRate": 61.39713}, {"year": 2022, "state": "FL", "count": 179, "medianNetProfitMargin": 0.070382, "medianOperatingProfitMargin": 0.146548, "medianCostToChargeRatio": 0.156341, "medianCommercialMargin": 0.484362, "medianMedicareMargin": -0.04772, "medianMedicaidMargin": -0.90414, "totalNetRevenue": 69858200601.0, "medianLaborHourlyRate": 50.793315}, {"year": 2022, "state": "GA", "count": 129, "medianNetProfitMargin": 0.034626, "medianOperatingProfitMargin": 0.099684, "medianCostToChargeRatio": 0.247667, "medianCommercialMargin": 0.361479, "medianMedicareMargin": 0.019577, "medianMedicaidMargin": -0.021651, "totalNetRevenue": 32246960993.0, "medianLaborHourlyRate": 47.182778}, {"year": 2022, "state": "HI", "count": 21, "medianNetProfitMargin": 0.044391, "medianOperatingProfitMargin": -0.056287, "medianCostToChargeRatio": 0.453144, "medianCommercialMargin": 0.108352, "medianMedicareMargin": -0.045216, "medianMedicaidMargin": -0.159021, "totalNetRevenue": 3265644138.0, "medianLaborHourlyRate": 64.043942}, {"year": 2022, "state": "IA", "count": 114, "medianNetProfitMargin": 0.061353, "medianOperatingProfitMargin": 0.051243, "medianCostToChargeRatio": 0.541251, "medianCommercialMargin": 0.215791, "medianMedicareMargin": 0.008216, "medianMedicaidMargin": -0.173821, "totalNetRevenue": 11020480532.0, "medianLaborHourlyRate": 48.079593}, {"year": 2022, "state": "ID", "count": 43, "medianNetProfitMargin": 0.009918, "medianOperatingProfitMargin": 0.109331, "medianCostToChargeRatio": 0.529348, "medianCommercialMargin": 0.321907, "medianMedicareMargin": 0.00411, "medianMedicaidMargin": -0.357298, "totalNetRevenue": 7152280762.0, "medianLaborHourlyRate": 47.576441}, {"year": 2022, "state": "IL", "count": 168, "medianNetProfitMargin": 0.030508, "medianOperatingProfitMargin": 0.127824, "medianCostToChargeRatio": 0.253334, "medianCommercialMargin": 0.435323, "medianMedicareMargin": -0.058818, "medianMedicaidMargin": -0.315821, "totalNetRevenue": 46365450981.0, "medianLaborHourlyRate": 52.557244}, {"year": 2022, "state": "IN", "count": 118, "medianNetProfitMargin": 0.040531, "medianOperatingProfitMargin": 0.180081, "medianCostToChargeRatio": 0.235444, "medianCommercialMargin": 0.489636, "medianMedicareMargin": -0.075846, "medianMedicaidMargin": -0.348206, "totalNetRevenue": 29222902295.0, "medianLaborHourlyRate": 56.516701}, {"year": 2022, "state": "KS", "count": 131, "medianNetProfitMargin": -0.011526, "medianOperatingProfitMargin": -0.032274, "medianCostToChargeRatio": 0.599981, "medianCommercialMargin": 0.093804, "medianMedicareMargin": -0.001661, "medianMedicaidMargin": -0.618626, "totalNetRevenue": 10490938786.0, "medianLaborHourlyRate": 46.107956}, {"year": 2022, "state": "KY", "count": 90, "medianNetProfitMargin": 0.034507, "medianOperatingProfitMargin": 0.126293, "medianCostToChargeRatio": 0.280114, "medianCommercialMargin": 0.34661, "medianMedicareMargin": 0.005644, "medianMedicaidMargin": 0.058508, "totalNetRevenue": 18120935500.0, "medianLaborHourlyRate": 49.438735}, {"year": 2022, "state": "LA", "count": 113, "medianNetProfitMargin": 0.06392, "medianOperatingProfitMargin": 0.034717, "medianCostToChargeRatio": 0.298786, "medianCommercialMargin": 0.212332, "medianMedicareMargin": -0.042887, "medianMedicaidMargin": -0.020442, "totalNetRevenue": 15694307967.0, "medianLaborHourlyRate": 43.389924}, {"year": 2022, "state": "MA", "count": 59, "medianNetProfitMargin": -0.017762, "medianOperatingProfitMargin": 0.016028, "medianCostToChargeRatio": 0.412199, "medianCommercialMargin": 0.185569, "medianMedicareMargin": -0.027958, "medianMedicaidMargin": -0.324656, "totalNetRevenue": 29423149134.0, "medianLaborHourlyRate": 59.939082}, {"year": 2022, "state": "MD", "count": 45, "medianNetProfitMargin": -0.038984, "medianOperatingProfitMargin": 0.159938, "medianCostToChargeRatio": 0.735518, "medianCommercialMargin": 0.154958, "medianMedicareMargin": 0.170121, "medianMedicaidMargin": 0.116233, "totalNetRevenue": 17494720979.0, "medianLaborHourlyRate": 54.90971}, {"year": 2022, "state": "ME", "count": 33, "medianNetProfitMargin": 0.001128, "medianOperatingProfitMargin": 0.110186, "medianCostToChargeRatio": 0.458823, "medianCommercialMargin": 0.295222, "medianMedicareMargin": -0.014178, "medianMedicaidMargin": -0.088232, "totalNetRevenue": 5664927408.0, "medianLaborHourlyRate": 50.309338}, {"year": 2022, "state": "MI", "count": 129, "medianNetProfitMargin": 0.006181, "medianOperatingProfitMargin": 0.115908, "medianCostToChargeRatio": 0.322995, "medianCommercialMargin": 0.293358, "medianMedicareMargin": 0.025364, "medianMedicaidMargin": -0.183485, "totalNetRevenue": 37230452582.0, "medianLaborHourlyRate": 50.014606}, {"year": 2022, "state": "MN", "count": 125, "medianNetProfitMargin": 0.001172, "medianOperatingProfitMargin": 0.129237, "medianCostToChargeRatio": 0.497921, "medianCommercialMargin": 0.336624, "medianMedicareMargin": -0.000761, "medianMedicaidMargin": -0.353249, "totalNetRevenue": 23160404338.0, "medianLaborHourlyRate": 61.621851}, {"year": 2022, "state": "MO", "count": 101, "medianNetProfitMargin": 0.023649, "medianOperatingProfitMargin": 0.112454, "medianCostToChargeRatio": 0.28533, "medianCommercialMargin": 0.366848, "medianMedicareMargin": 0.006046, "medianMedicaidMargin": -0.159849, "totalNetRevenue": 22880127636.0, "medianLaborHourlyRate": 50.762548}, {"year": 2022, "state": "MS", "count": 93, "medianNetProfitMargin": -0.013477, "medianOperatingProfitMargin": -0.028082, "medianCostToChargeRatio": 0.364131, "medianCommercialMargin": 0.047461, "medianMedicareMargin": 0.009918, "medianMedicaidMargin": 0.191813, "totalNetRevenue": 8251734295.0, "medianLaborHourlyRate": 43.21381}, {"year": 2022, "state": "MT", "count": 61, "medianNetProfitMargin": -0.000925, "medianOperatingProfitMargin": 0.032903, "medianCostToChargeRatio": 0.774797, "medianCommercialMargin": 0.182505, "medianMedicareMargin": 0.003226, "medianMedicaidMargin": -0.014777, "totalNetRevenue": 5077533097.0, "medianLaborHourlyRate": 48.765049}, {"year": 2022, "state": "NC", "count": 102, "medianNetProfitMargin": 0.015721, "medianOperatingProfitMargin": 0.169923, "medianCostToChargeRatio": 0.244427, "medianCommercialMargin": 0.446066, "medianMedicareMargin": -0.007899, "medianMedicaidMargin": 0.049618, "totalNetRevenue": 36524320958.0, "medianLaborHourlyRate": 49.015324}, {"year": 2022, "state": "ND", "count": 44, "medianNetProfitMargin": 0.039099, "medianOperatingProfitMargin": 0.035676, "medianCostToChargeRatio": 0.766996, "medianCommercialMargin": 0.165885, "medianMedicareMargin": 0.011432, "medianMedicaidMargin": -0.236291, "totalNetRevenue": 4663709511.0, "medianLaborHourlyRate": 52.709557}, {"year": 2022, "state": "NE", "count": 87, "medianNetProfitMargin": 0.037185, "medianOperatingProfitMargin": 0.069887, "medianCostToChargeRatio": 0.639647, "medianCommercialMargin": 0.245603, "medianMedicareMargin": 0.006391, "medianMedicaidMargin": -0.312299, "totalNetRevenue": 7547126002.0, "medianLaborHourlyRate": 54.345048}, {"year": 2022, "state": "NH", "count": 26, "medianNetProfitMargin": -0.021378, "medianOperatingProfitMargin": 0.137646, "medianCostToChargeRatio": 0.359788, "medianCommercialMargin": 0.384032, "medianMedicareMargin": -0.023535, "medianMedicaidMargin": -0.16925, "totalNetRevenue": 6034901475.0, "medianLaborHourlyRate": 54.582038}, {"year": 2022, "state": "NJ", "count": 63, "medianNetProfitMargin": 0.024646, "medianOperatingProfitMargin": 0.10539, "medianCostToChargeRatio": 0.190191, "medianCommercialMargin": 0.384633, "medianMedicareMargin": -0.079832, "medianMedicaidMargin": -0.265437, "totalNetRevenue": 30054866379.0, "medianLaborHourlyRate": 58.146496}, {"year": 2022, "state": "NM", "count": 43, "medianNetProfitMargin": 0.040625, "medianOperatingProfitMargin": 0.11079, "medianCostToChargeRatio": 0.348089, "medianCommercialMargin": 0.515046, "medianMedicareMargin": -0.138691, "medianMedicaidMargin": -0.104802, "totalNetRevenue": 6593244439.0, "medianLaborHourlyRate": 53.935441}, {"year": 2022, "state": "NV", "count": 35, "medianNetProfitMargin": 0.093173, "medianOperatingProfitMargin": 0.10593, "medianCostToChargeRatio": 0.177923, "medianCommercialMargin": 0.382473, "medianMedicareMargin": 0.025117, "medianMedicaidMargin": -0.768296, "totalNetRevenue": 7661010068.0, "medianLaborHourlyRate": 64.952943}, {"year": 2022, "state": "NY", "count": 156, "medianNetProfitMargin": -0.039655, "medianOperatingProfitMargin": 0.036378, "medianCostToChargeRatio": 0.356788, "medianCommercialMargin": 0.306059, "medianMedicareMargin": -0.076948, "medianMedicaidMargin": -0.504559, "totalNetRevenue": 88016483647.0, "medianLaborHourlyRate": 61.235517}, {"year": 2022, "state": "OH", "count": 157, "medianNetProfitMargin": 0.021243, "medianOperatingProfitMargin": 0.133222, "medianCostToChargeRatio": 0.265564, "medianCommercialMargin": 0.404365, "medianMedicareMargin": -0.013567, "medianMedicaidMargin": -0.368729, "totalNetRevenue": 48612128425.0, "medianLaborHourlyRate": 49.984404}, {"year": 2022, "state": "OK", "count": 118, "medianNetProfitMargin": -0.005401, "medianOperatingProfitMargin": 0.042255, "medianCostToChargeRatio": 0.269552, "medianCommercialMargin": 0.340931, "medianMedicareMargin": 0.010611, "medianMedicaidMargin": -0.221189, "totalNetRevenue": 12454781323.0, "medianLaborHourlyRate": 47.254251}, {"year": 2022, "state": "OR", "count": 59, "medianNetProfitMargin": 0.001848, "medianOperatingProfitMargin": 0.143889, "medianCostToChargeRatio": 0.406328, "medianCommercialMargin": 0.459186, "medianMedicareMargin": -0.037401, "medianMedicaidMargin": -0.25706, "totalNetRevenue": 14950233229.0, "medianLaborHourlyRate": 67.339623}, {"year": 2022, "state": "PA", "count": 154, "medianNetProfitMargin": 0.010638, "medianOperatingProfitMargin": 0.126525, "medianCostToChargeRatio": 0.221997, "medianCommercialMargin": 0.298398, "medianMedicareMargin": -0.0089, "medianMedicaidMargin": -0.319183, "totalNetRevenue": 49936550540.0, "medianLaborHourlyRate": 50.524716}, {"year": 2022, "state": "RI", "count": 10, "medianNetProfitMargin": -0.058036, "medianOperatingProfitMargin": 0.042408, "medianCostToChargeRatio": 0.297431, "medianCommercialMargin": 0.206457, "medianMedicareMargin": -0.071979, "medianMedicaidMargin": -0.063644, "totalNetRevenue": 3505214272.0, "medianLaborHourlyRate": 52.953588}, {"year": 2022, "state": "SC", "count": 57, "medianNetProfitMargin": 0.035357, "medianOperatingProfitMargin": 0.133054, "medianCostToChargeRatio": 0.21265, "medianCommercialMargin": 0.440221, "medianMedicareMargin": -0.010221, "medianMedicaidMargin": -0.029057, "totalNetRevenue": 17194587231.0, "medianLaborHourlyRate": 48.726086}, {"year": 2022, "state": "SD", "count": 57, "medianNetProfitMargin": 0.048781, "medianOperatingProfitMargin": 0.163931, "medianCostToChargeRatio": 0.462386, "medianCommercialMargin": 0.38378, "medianMedicareMargin": 0.007769, "medianMedicaidMargin": -0.186457, "totalNetRevenue": 5263811411.0, "medianLaborHourlyRate": 45.940954}, {"year": 2022, "state": "TN", "count": 95, "medianNetProfitMargin": 0.027728, "medianOperatingProfitMargin": 0.130811, "medianCostToChargeRatio": 0.193194, "medianCommercialMargin": 0.348276, "medianMedicareMargin": 0.065468, "medianMedicaidMargin": -0.275979, "totalNetRevenue": 22906861097.0, "medianLaborHourlyRate": 44.614389}, {"year": 2022, "state": "TX", "count": 363, "medianNetProfitMargin": 0.089194, "medianOperatingProfitMargin": 0.102891, "medianCostToChargeRatio": 0.220254, "medianCommercialMargin": 0.325578, "medianMedicareMargin": 0.006478, "medianMedicaidMargin": 0.178602, "totalNetRevenue": 80252538309.0, "medianLaborHourlyRate": 50.768837}, {"year": 2022, "state": "UT", "count": 46, "medianNetProfitMargin": 0.137118, "medianOperatingProfitMargin": 0.290235, "medianCostToChargeRatio": 0.306268, "medianCommercialMargin": 0.454672, "medianMedicareMargin": 0.00186, "medianMedicaidMargin": 0.190128, "totalNetRevenue": 10551766788.0, "medianLaborHourlyRate": 50.56514}, {"year": 2022, "state": "VA", "count": 79, "medianNetProfitMargin": 0.070444, "medianOperatingProfitMargin": 0.170796, "medianCostToChargeRatio": 0.243378, "medianCommercialMargin": 0.431996, "medianMedicareMargin": -0.10066, "medianMedicaidMargin": 0.112885, "totalNetRevenue": 26109186425.0, "medianLaborHourlyRate": 50.974732}, {"year": 2022, "state": "VT", "count": 14, "medianNetProfitMargin": -0.024427, "medianOperatingProfitMargin": 0.069955, "medianCostToChargeRatio": 0.449633, "medianCommercialMargin": 0.335501, "medianMedicareMargin": 0.004503, "medianMedicaidMargin": -0.327398, "totalNetRevenue": 2745166033.0, "medianLaborHourlyRate": 48.498541}, {"year": 2022, "state": "WA", "count": 87, "medianNetProfitMargin": -0.028192, "medianOperatingProfitMargin": 0.103837, "medianCostToChargeRatio": 0.318087, "medianCommercialMargin": 0.399313, "medianMedicareMargin": -0.027032, "medianMedicaidMargin": -0.431469, "totalNetRevenue": 24643616740.0, "medianLaborHourlyRate": 68.348902}, {"year": 2022, "state": "WI", "count": 126, "medianNetProfitMargin": 0.048318, "medianOperatingProfitMargin": 0.193606, "medianCostToChargeRatio": 0.365388, "medianCommercialMargin": 0.426339, "medianMedicareMargin": -0.002957, "medianMedicaidMargin": -0.602613, "totalNetRevenue": 24623978961.0, "medianLaborHourlyRate": 53.973556}, {"year": 2022, "state": "WV", "count": 46, "medianNetProfitMargin": 0.033502, "medianOperatingProfitMargin": 0.086354, "medianCostToChargeRatio": 0.349735, "medianCommercialMargin": 0.474007, "medianMedicareMargin": 0.009481, "medianMedicaidMargin": -0.210283, "totalNetRevenue": 8337568398.0, "medianLaborHourlyRate": 43.123875}, {"year": 2022, "state": "WY", "count": 26, "medianNetProfitMargin": 0.013018, "medianOperatingProfitMargin": 0.134918, "medianCostToChargeRatio": 0.583965, "medianCommercialMargin": 0.375926, "medianMedicareMargin": 0.001608, "medianMedicaidMargin": -0.407469, "totalNetRevenue": 1993881729.0, "medianLaborHourlyRate": 54.914958}, {"year": 2023, "state": "AK", "count": 21, "medianNetProfitMargin": 0.076112, "medianOperatingProfitMargin": 0.146939, "medianCostToChargeRatio": 0.588623, "medianCommercialMargin": 0.52627, "medianMedicareMargin": -0.010601, "medianMedicaidMargin": -0.077103, "totalNetRevenue": 2781973463.0, "medianLaborHourlyRate": 65.395326}, {"year": 2023, "state": "AL", "count": 86, "medianNetProfitMargin": 0.001336, "medianOperatingProfitMargin": 0.025733, "medianCostToChargeRatio": 0.275786, "medianCommercialMargin": 0.043251, "medianMedicareMargin": 0.04456, "medianMedicaidMargin": 0.249912, "totalNetRevenue": 13820566030.0, "medianLaborHourlyRate": 41.039734}, {"year": 2023, "state": "AR", "count": 76, "medianNetProfitMargin": 0.008384, "medianOperatingProfitMargin": 0.026704, "medianCostToChargeRatio": 0.29731, "medianCommercialMargin": 0.11691, "medianMedicareMargin": 0.007522, "medianMedicaidMargin": -0.065741, "totalNetRevenue": 8416609798.0, "medianLaborHourlyRate": 45.562184}, {"year": 2023, "state": "AZ", "count": 81, "medianNetProfitMargin": 0.057239, "medianOperatingProfitMargin": 0.161465, "medianCostToChargeRatio": 0.18536, "medianCommercialMargin": 0.475429, "medianMedicareMargin": -0.027727, "medianMedicaidMargin": -0.157948, "totalNetRevenue": 22557972400.0, "medianLaborHourlyRate": 55.440826}, {"year": 2023, "state": "CA", "count": 319, "medianNetProfitMargin": 0.030874, "medianOperatingProfitMargin": 0.10206, "medianCostToChargeRatio": 0.211467, "medianCommercialMargin": 0.481981, "medianMedicareMargin": -0.110063, "medianMedicaidMargin": -0.231173, "totalNetRevenue": 124803731530.0, "medianLaborHourlyRate": 76.644559}, {"year": 2023, "state": "CO", "count": 82, "medianNetProfitMargin": 0.026804, "medianOperatingProfitMargin": 0.164291, "medianCostToChargeRatio": 0.267016, "medianCommercialMargin": 0.43587, "medianMedicareMargin": -0.052358, "medianMedicaidMargin": -0.360978, "totalNetRevenue": 19828373663.0, "medianLaborHourlyRate": 58.745055}, {"year": 2023, "state": "CT", "count": 28, "medianNetProfitMargin": -0.007127, "medianOperatingProfitMargin": 0.094524, "medianCostToChargeRatio": 0.279555, "medianCommercialMargin": 0.310795, "medianMedicareMargin": -0.062777, "medianMedicaidMargin": -0.379166, "totalNetRevenue": 14793708954.0, "medianLaborHourlyRate": 59.099637}, {"year": 2023, "state": "DC", "count": 6, "medianNetProfitMargin": 0.050083, "medianOperatingProfitMargin": 0.145755, "medianCostToChargeRatio": 0.278963, "medianCommercialMargin": 0.3338, "medianMedicareMargin": -0.115035, "medianMedicaidMargin": 0.300481, "totalNetRevenue": 4141513718.0, "medianLaborHourlyRate": 63.670252}, {"year": 2023, "state": "DE", "count": 6, "medianNetProfitMargin": -0.01211, "medianOperatingProfitMargin": 0.086773, "medianCostToChargeRatio": 0.327066, "medianCommercialMargin": 0.425078, "medianMedicareMargin": -0.31208, "medianMedicaidMargin": -0.229682, "totalNetRevenue": 3980447817.0, "medianLaborHourlyRate": 67.188305}, {"year": 2023, "state": "FL", "count": 180, "medianNetProfitMargin": 0.094678, "medianOperatingProfitMargin": 0.165895, "medianCostToChargeRatio": 0.15059, "medianCommercialMargin": 0.499001, "medianMedicareMargin": -0.055004, "medianMedicaidMargin": -0.704851, "totalNetRevenue": 77782210425.0, "medianLaborHourlyRate": 49.87781}, {"year": 2023, "state": "GA", "count": 127, "medianNetProfitMargin": 0.064332, "medianOperatingProfitMargin": 0.120072, "medianCostToChargeRatio": 0.237814, "medianCommercialMargin": 0.354131, "medianMedicareMargin": 0.008774, "medianMedicaidMargin": 0.116342, "totalNetRevenue": 35372874678.0, "medianLaborHourlyRate": 48.478291}, {"year": 2023, "state": "HI", "count": 21, "medianNetProfitMargin": 0.081877, "medianOperatingProfitMargin": -0.006917, "medianCostToChargeRatio": 0.414324, "medianCommercialMargin": 0.129658, "medianMedicareMargin": -0.018281, "medianMedicaidMargin": -0.215228, "totalNetRevenue": 3463933848.0, "medianLaborHourlyRate": 71.315705}, {"year": 2023, "state": "IA", "count": 113, "medianNetProfitMargin": 0.054266, "medianOperatingProfitMargin": 0.044741, "medianCostToChargeRatio": 0.52941, "medianCommercialMargin": 0.192372, "medianMedicareMargin": -0.004099, "medianMedicaidMargin": -0.16598, "totalNetRevenue": 11667627232.0, "medianLaborHourlyRate": 49.571398}, {"year": 2023, "state": "ID", "count": 43, "medianNetProfitMargin": 0.041084, "medianOperatingProfitMargin": 0.122713, "medianCostToChargeRatio": 0.530585, "medianCommercialMargin": 0.362428, "medianMedicareMargin": -0.00404, "medianMedicaidMargin": -0.170578, "totalNetRevenue": 7767953794.0, "medianLaborHourlyRate": 50.813959}, {"year": 2023, "state": "IL", "count": 170, "medianNetProfitMargin": 0.045778, "medianOperatingProfitMargin": 0.140457, "medianCostToChargeRatio": 0.243477, "medianCommercialMargin": 0.429689, "medianMedicareMargin": -0.042947, "medianMedicaidMargin": -0.231385, "totalNetRevenue": 48506947098.0, "medianLaborHourlyRate": 53.755278}, {"year": 2023, "state": "IN", "count": 116, "medianNetProfitMargin": 0.060009, "medianOperatingProfitMargin": 0.199356, "medianCostToChargeRatio": 0.224251, "medianCommercialMargin": 0.478772, "medianMedicareMargin": -0.057589, "medianMedicaidMargin": -0.231318, "totalNetRevenue": 30679119338.0, "medianLaborHourlyRate": 54.223556}, {"year": 2023, "state": "KS", "count": 130, "medianNetProfitMargin": -0.026622, "medianOperatingProfitMargin": -0.048945, "medianCostToChargeRatio": 0.602079, "medianCommercialMargin": 0.070827, "medianMedicareMargin": -0.008878, "medianMedicaidMargin": -0.562122, "totalNetRevenue": 11309779458.0, "medianLaborHourlyRate": 46.913776}, {"year": 2023, "state": "KY", "count": 91, "medianNetProfitMargin": 0.077701, "medianOperatingProfitMargin": 0.140335, "medianCostToChargeRatio": 0.274464, "medianCommercialMargin": 0.310118, "medianMedicareMargin": -0.007159, "medianMedicaidMargin": 0.227185, "totalNetRevenue": 19761259556.0, "medianLaborHourlyRate": 48.703469}, {"year": 2023, "state": "LA", "count": 111, "medianNetProfitMargin": 0.079063, "medianOperatingProfitMargin": 0.079038, "medianCostToChargeRatio": 0.283596, "medianCommercialMargin": 0.207602, "medianMedicareMargin": -0.023868, "medianMedicaidMargin": 0.06063, "totalNetRevenue": 17295635921.0, "medianLaborHourlyRate": 43.830976}, {"year": 2023, "state": "MA", "count": 59, "medianNetProfitMargin": 0.019663, "medianOperatingProfitMargin": 0.045049, "medianCostToChargeRatio": 0.396886, "medianCommercialMargin": 0.153495, "medianMedicareMargin": -0.024534, "medianMedicaidMargin": -0.22359, "totalNetRevenue": 31936394834.0, "medianLaborHourlyRate": 61.648886}, {"year": 2023, "state": "MD", "count": 44, "medianNetProfitMargin": 0.026403, "medianOperatingProfitMargin": 0.160685, "medianCostToChargeRatio": 0.718939, "medianCommercialMargin": 0.165988, "medianMedicareMargin": 0.151507, "medianMedicaidMargin": 0.153947, "totalNetRevenue": 17512976529.0, "medianLaborHourlyRate": 55.566872}, {"year": 2023, "state": "ME", "count": 33, "medianNetProfitMargin": 0.01258, "medianOperatingProfitMargin": 0.113066, "medianCostToChargeRatio": 0.426053, "medianCommercialMargin": 0.269923, "medianMedicareMargin": -0.023486, "medianMedicaidMargin": -0.057612, "totalNetRevenue": 7039726134.0, "medianLaborHourlyRate": 50.18085}, {"year": 2023, "state": "MI", "count": 129, "medianNetProfitMargin": 0.013226, "medianOperatingProfitMargin": 0.122374, "medianCostToChargeRatio": 0.307131, "medianCommercialMargin": 0.255054, "medianMedicareMargin": 0.036164, "medianMedicaidMargin": -0.19304, "totalNetRevenue": 37810580449.0, "medianLaborHourlyRate": 49.086524}, {"year": 2023, "state": "MN", "count": 123, "medianNetProfitMargin": 0.037683, "medianOperatingProfitMargin": 0.13005, "medianCostToChargeRatio": 0.490263, "medianCommercialMargin": 0.366065, "medianMedicareMargin": -0.007745, "medianMedicaidMargin": -0.367636, "totalNetRevenue": 24351839862.0, "medianLaborHourlyRate": 63.29237}, {"year": 2023, "state": "MO", "count": 100, "medianNetProfitMargin": 0.03226, "medianOperatingProfitMargin": 0.122125, "medianCostToChargeRatio": 0.271359, "medianCommercialMargin": 0.328904, "medianMedicareMargin": 0.001382, "medianMedicaidMargin": -0.058145, "totalNetRevenue": 25821775995.0, "medianLaborHourlyRate": 50.451784}, {"year": 2023, "state": "MS", "count": 93, "medianNetProfitMargin": -0.010106, "medianOperatingProfitMargin": 0.011382, "medianCostToChargeRatio": 0.346428, "medianCommercialMargin": 0.140676, "medianMedicareMargin": 0.0079, "medianMedicaidMargin": 0.218041, "totalNetRevenue": 8756204781.0, "medianLaborHourlyRate": 41.789733}, {"year": 2023, "state": "MT", "count": 61, "medianNetProfitMargin": 0.033941, "medianOperatingProfitMargin": 0.043892, "medianCostToChargeRatio": 0.725558, "medianCommercialMargin": 0.195006, "medianMedicareMargin": -0.008316, "medianMedicaidMargin": 0.01578, "totalNetRevenue": 5570114587.0, "medianLaborHourlyRate": 49.980658}, {"year": 2023, "state": "NC", "count": 103, "medianNetProfitMargin": 0.061069, "medianOperatingProfitMargin": 0.19171, "medianCostToChargeRatio": 0.240176, "medianCommercialMargin": 0.465618, "medianMedicareMargin": -0.006996, "medianMedicaidMargin": 0.163912, "totalNetRevenue": 41649777543.0, "medianLaborHourlyRate": 51.928013}, {"year": 2023, "state": "ND", "count": 44, "medianNetProfitMargin": 0.026751, "medianOperatingProfitMargin": 0.010459, "medianCostToChargeRatio": 0.762548, "medianCommercialMargin": 0.154584, "medianMedicareMargin": -0.002374, "medianMedicaidMargin": -0.220908, "totalNetRevenue": 4894641851.0, "medianLaborHourlyRate": 50.236698}, {"year": 2023, "state": "NE", "count": 88, "medianNetProfitMargin": 0.06234, "medianOperatingProfitMargin": 0.049618, "medianCostToChargeRatio": 0.650701, "medianCommercialMargin": 0.24271, "medianMedicareMargin": -0.0052, "medianMedicaidMargin": -0.399531, "totalNetRevenue": 7966721262.0, "medianLaborHourlyRate": 57.109324}, {"year": 2023, "state": "NH", "count": 26, "medianNetProfitMargin": 0.092987, "medianOperatingProfitMargin": 0.166248, "medianCostToChargeRatio": 0.341707, "medianCommercialMargin": 0.369427, "medianMedicareMargin": -0.025324, "medianMedicaidMargin": -0.078685, "totalNetRevenue": 6463722641.0, "medianLaborHourlyRate": 56.08042}, {"year": 2023, "state": "NJ", "count": 63, "medianNetProfitMargin": 0.036289, "medianOperatingProfitMargin": 0.136263, "medianCostToChargeRatio": 0.186346, "medianCommercialMargin": 0.448307, "medianMedicareMargin": -0.091284, "medianMedicaidMargin": -0.230407, "totalNetRevenue": 32574173372.0, "medianLaborHourlyRate": 58.310922}, {"year": 2023, "state": "NM", "count": 41, "medianNetProfitMargin": 0.015084, "medianOperatingProfitMargin": 0.109192, "medianCostToChargeRatio": 0.323599, "medianCommercialMargin": 0.503665, "medianMedicareMargin": -0.089126, "medianMedicaidMargin": -0.276854, "totalNetRevenue": 6769559654.0, "medianLaborHourlyRate": 54.308437}, {"year": 2023, "state": "NV", "count": 35, "medianNetProfitMargin": 0.078798, "medianOperatingProfitMargin": 0.11544, "medianCostToChargeRatio": 0.185599, "medianCommercialMargin": 0.347165, "medianMedicareMargin": 0.022438, "medianMedicaidMargin": -0.815599, "totalNetRevenue": 8076121121.0, "medianLaborHourlyRate": 61.973733}, {"year": 2023, "state": "NY", "count": 155, "medianNetProfitMargin": 0.002699, "medianOperatingProfitMargin": 0.043274, "medianCostToChargeRatio": 0.338639, "medianCommercialMargin": 0.308663, "medianMedicareMargin": -0.099568, "medianMedicaidMargin": -0.407329, "totalNetRevenue": 94521013501.0, "medianLaborHourlyRate": 63.410609}, {"year": 2023, "state": "OH", "count": 153, "medianNetProfitMargin": 0.055951, "medianOperatingProfitMargin": 0.157277, "medianCostToChargeRatio": 0.249681, "medianCommercialMargin": 0.419355, "medianMedicareMargin": -0.006196, "medianMedicaidMargin": -0.425345, "totalNetRevenue": 51490687497.0, "medianLaborHourlyRate": 49.622156}, {"year": 2023, "state": "OK", "count": 117, "medianNetProfitMargin": -0.001342, "medianOperatingProfitMargin": 0.027252, "medianCostToChargeRatio": 0.271552, "medianCommercialMargin": 0.307282, "medianMedicareMargin": 0.002035, "medianMedicaidMargin": -0.174926, "totalNetRevenue": 13254418729.0, "medianLaborHourlyRate": 46.450059}, {"year": 2023, "state": "OR", "count": 58, "medianNetProfitMargin": 0.004058, "medianOperatingProfitMargin": 0.14067, "medianCostToChargeRatio": 0.392364, "medianCommercialMargin": 0.491891, "medianMedicareMargin": -0.055531, "medianMedicaidMargin": -0.272007, "totalNetRevenue": 16004597360.0, "medianLaborHourlyRate": 67.434798}, {"year": 2023, "state": "PA", "count": 151, "medianNetProfitMargin": 0.017127, "medianOperatingProfitMargin": 0.108047, "medianCostToChargeRatio": 0.224544, "medianCommercialMargin": 0.288032, "medianMedicareMargin": -0.024465, "medianMedicaidMargin": -0.35045, "totalNetRevenue": 50613828934.0, "medianLaborHourlyRate": 54.062848}, {"year": 2023, "state": "RI", "count": 10, "medianNetProfitMargin": 0.003469, "medianOperatingProfitMargin": 0.0499, "medianCostToChargeRatio": 0.281507, "medianCommercialMargin": 0.164006, "medianMedicareMargin": -0.063671, "medianMedicaidMargin": -0.052872, "totalNetRevenue": 3791624316.0, "medianLaborHourlyRate": 57.037111}, {"year": 2023, "state": "SC", "count": 54, "medianNetProfitMargin": 0.041671, "medianOperatingProfitMargin": 0.14954, "medianCostToChargeRatio": 0.212318, "medianCommercialMargin": 0.430224, "medianMedicareMargin": -0.036253, "medianMedicaidMargin": -0.020956, "totalNetRevenue": 18332904765.0, "medianLaborHourlyRate": 49.929153}, {"year": 2023, "state": "SD", "count": 57, "medianNetProfitMargin": 0.062379, "medianOperatingProfitMargin": 0.176136, "medianCostToChargeRatio": 0.452949, "medianCommercialMargin": 0.37646, "medianMedicareMargin": -0.002552, "medianMedicaidMargin": -0.09555, "totalNetRevenue": 5536638567.0, "medianLaborHourlyRate": 48.423058}, {"year": 2023, "state": "TN", "count": 96, "medianNetProfitMargin": 0.025581, "medianOperatingProfitMargin": 0.108173, "medianCostToChargeRatio": 0.194681, "medianCommercialMargin": 0.326314, "medianMedicareMargin": 0.070648, "medianMedicaidMargin": -0.206853, "totalNetRevenue": 24364380377.0, "medianLaborHourlyRate": 45.508532}, {"year": 2023, "state": "TX", "count": 367, "medianNetProfitMargin": 0.094138, "medianOperatingProfitMargin": 0.114278, "medianCostToChargeRatio": 0.217755, "medianCommercialMargin": 0.328518, "medianMedicareMargin": -0.002125, "medianMedicaidMargin": 0.155601, "totalNetRevenue": 86151482181.0, "medianLaborHourlyRate": 51.708241}, {"year": 2023, "state": "UT", "count": 46, "medianNetProfitMargin": 0.139489, "medianOperatingProfitMargin": 0.311384, "medianCostToChargeRatio": 0.286078, "medianCommercialMargin": 0.471799, "medianMedicareMargin": -0.005356, "medianMedicaidMargin": 0.294673, "totalNetRevenue": 11228304795.0, "medianLaborHourlyRate": 53.384765}, {"year": 2023, "state": "VA", "count": 79, "medianNetProfitMargin": 0.088997, "medianOperatingProfitMargin": 0.197717, "medianCostToChargeRatio": 0.218372, "medianCommercialMargin": 0.409328, "medianMedicareMargin": -0.085178, "medianMedicaidMargin": 0.18671, "totalNetRevenue": 29743413709.0, "medianLaborHourlyRate": 52.073109}, {"year": 2023, "state": "VT", "count": 14, "medianNetProfitMargin": -0.009337, "medianOperatingProfitMargin": 0.034781, "medianCostToChargeRatio": 0.43371, "medianCommercialMargin": 0.323267, "medianMedicareMargin": -0.012027, "medianMedicaidMargin": -0.554475, "totalNetRevenue": 3286481009.0, "medianLaborHourlyRate": 57.172733}, {"year": 2023, "state": "WA", "count": 87, "medianNetProfitMargin": -0.003603, "medianOperatingProfitMargin": 0.068328, "medianCostToChargeRatio": 0.325256, "medianCommercialMargin": 0.376193, "medianMedicareMargin": -0.024164, "medianMedicaidMargin": -0.429037, "totalNetRevenue": 26790312731.0, "medianLaborHourlyRate": 71.332898}, {"year": 2023, "state": "WI", "count": 125, "medianNetProfitMargin": 0.086016, "medianOperatingProfitMargin": 0.212032, "medianCostToChargeRatio": 0.351141, "medianCommercialMargin": 0.464783, "medianMedicareMargin": 0.000784, "medianMedicaidMargin": -0.669431, "totalNetRevenue": 27173446193.0, "medianLaborHourlyRate": 54.409097}, {"year": 2023, "state": "WV", "count": 46, "medianNetProfitMargin": 0.02943, "medianOperatingProfitMargin": 0.098317, "medianCostToChargeRatio": 0.322829, "medianCommercialMargin": 0.415252, "medianMedicareMargin": -0.01806, "medianMedicaidMargin": -0.210677, "totalNetRevenue": 7737653872.0, "medianLaborHourlyRate": 47.705137}, {"year": 2023, "state": "WY", "count": 26, "medianNetProfitMargin": 0.004485, "medianOperatingProfitMargin": 0.164104, "medianCostToChargeRatio": 0.556695, "medianCommercialMargin": 0.374975, "medianMedicareMargin": -0.007219, "medianMedicaidMargin": -0.246047, "totalNetRevenue": 2097102744.0, "medianLaborHourlyRate": 58.090476}, {"year": 2024, "state": "AK", "count": 21, "medianNetProfitMargin": 0.078771, "medianOperatingProfitMargin": 0.15436, "medianCostToChargeRatio": 0.545303, "medianCommercialMargin": 0.528058, "medianMedicareMargin": -0.012195, "medianMedicaidMargin": -0.064804, "totalNetRevenue": 2914305736.0, "medianLaborHourlyRate": 67.720251}, {"year": 2024, "state": "AL", "count": 85, "medianNetProfitMargin": 0.001951, "medianOperatingProfitMargin": 0.041562, "medianCostToChargeRatio": 0.269614, "medianCommercialMargin": 0.030534, "medianMedicareMargin": 0.076823, "medianMedicaidMargin": 0.266776, "totalNetRevenue": 14717213422.0, "medianLaborHourlyRate": 40.576047}, {"year": 2024, "state": "AR", "count": 75, "medianNetProfitMargin": 0.004674, "medianOperatingProfitMargin": 0.015863, "medianCostToChargeRatio": 0.292599, "medianCommercialMargin": 0.168971, "medianMedicareMargin": 0.014999, "medianMedicaidMargin": -0.088748, "totalNetRevenue": 8812975157.0, "medianLaborHourlyRate": 44.974627}, {"year": 2024, "state": "AZ", "count": 82, "medianNetProfitMargin": 0.106802, "medianOperatingProfitMargin": 0.174475, "medianCostToChargeRatio": 0.188756, "medianCommercialMargin": 0.45414, "medianMedicareMargin": -0.007921, "medianMedicaidMargin": -0.097544, "totalNetRevenue": 24514660522.0, "medianLaborHourlyRate": 56.209943}, {"year": 2024, "state": "CA", "count": 316, "medianNetProfitMargin": 0.038777, "medianOperatingProfitMargin": 0.127346, "medianCostToChargeRatio": 0.200958, "medianCommercialMargin": 0.469928, "medianMedicareMargin": -0.072463, "medianMedicaidMargin": -0.245426, "totalNetRevenue": 136037591626.0, "medianLaborHourlyRate": 77.548699}, {"year": 2024, "state": "CO", "count": 83, "medianNetProfitMargin": 0.04856, "medianOperatingProfitMargin": 0.173926, "medianCostToChargeRatio": 0.277965, "medianCommercialMargin": 0.443549, "medianMedicareMargin": -0.026124, "medianMedicaidMargin": -0.29706, "totalNetRevenue": 20946016249.0, "medianLaborHourlyRate": 59.42495}, {"year": 2024, "state": "CT", "count": 26, "medianNetProfitMargin": 0.006396, "medianOperatingProfitMargin": 0.121731, "medianCostToChargeRatio": 0.26206, "medianCommercialMargin": 0.387859, "medianMedicareMargin": -0.031726, "medianMedicaidMargin": -0.380095, "totalNetRevenue": 16062276020.0, "medianLaborHourlyRate": 58.164424}, {"year": 2024, "state": "DC", "count": 6, "medianNetProfitMargin": 0.017048, "medianOperatingProfitMargin": 0.151553, "medianCostToChargeRatio": 0.270219, "medianCommercialMargin": 0.368848, "medianMedicareMargin": -0.113082, "medianMedicaidMargin": 0.086894, "totalNetRevenue": 4281644925.0, "medianLaborHourlyRate": 61.881744}, {"year": 2024, "state": "DE", "count": 6, "medianNetProfitMargin": 0.070944, "medianOperatingProfitMargin": 0.197394, "medianCostToChargeRatio": 0.290534, "medianCommercialMargin": 0.484541, "medianMedicareMargin": -0.141657, "medianMedicaidMargin": -0.208817, "totalNetRevenue": 4317876334.0, "medianLaborHourlyRate": 61.569333}, {"year": 2024, "state": "FL", "count": 180, "medianNetProfitMargin": 0.139328, "medianOperatingProfitMargin": 0.196959, "medianCostToChargeRatio": 0.142209, "medianCommercialMargin": 0.479656, "medianMedicareMargin": -0.02737, "medianMedicaidMargin": -0.493662, "totalNetRevenue": 87030893803.0, "medianLaborHourlyRate": 50.117365}, {"year": 2024, "state": "GA", "count": 127, "medianNetProfitMargin": 0.082048, "medianOperatingProfitMargin": 0.145243, "medianCostToChargeRatio": 0.216284, "medianCommercialMargin": 0.36904, "medianMedicareMargin": 0.013653, "medianMedicaidMargin": 0.191653, "totalNetRevenue": 39212263624.0, "medianLaborHourlyRate": 50.240821}, {"year": 2024, "state": "HI", "count": 21, "medianNetProfitMargin": 0.100108, "medianOperatingProfitMargin": 0.028522, "medianCostToChargeRatio": 0.430579, "medianCommercialMargin": 0.069719, "medianMedicareMargin": -0.006519, "medianMedicaidMargin": -0.269876, "totalNetRevenue": 3687669873.0, "medianLaborHourlyRate": 71.252346}, {"year": 2024, "state": "IA", "count": 112, "medianNetProfitMargin": 0.10959, "medianOperatingProfitMargin": 0.154445, "medianCostToChargeRatio": 0.512738, "medianCommercialMargin": 0.263098, "medianMedicareMargin": -0.004321, "medianMedicaidMargin": 0.270578, "totalNetRevenue": 13342650034.0, "medianLaborHourlyRate": 49.416161}, {"year": 2024, "state": "ID", "count": 43, "medianNetProfitMargin": 0.01918, "medianOperatingProfitMargin": 0.123468, "medianCostToChargeRatio": 0.53748, "medianCommercialMargin": 0.328885, "medianMedicareMargin": 0.000383, "medianMedicaidMargin": -0.132619, "totalNetRevenue": 8737422315.0, "medianLaborHourlyRate": 52.978628}, {"year": 2024, "state": "IL", "count": 170, "medianNetProfitMargin": 0.043683, "medianOperatingProfitMargin": 0.131025, "medianCostToChargeRatio": 0.237099, "medianCommercialMargin": 0.408982, "medianMedicareMargin": -0.015455, "medianMedicaidMargin": -0.19994, "totalNetRevenue": 50456566967.0, "medianLaborHourlyRate": 54.788618}, {"year": 2024, "state": "IN", "count": 115, "medianNetProfitMargin": 0.073424, "medianOperatingProfitMargin": 0.181609, "medianCostToChargeRatio": 0.223232, "medianCommercialMargin": 0.450112, "medianMedicareMargin": -0.071596, "medianMedicaidMargin": -0.274921, "totalNetRevenue": 31425238110.0, "medianLaborHourlyRate": 54.297968}, {"year": 2024, "state": "KS", "count": 130, "medianNetProfitMargin": -0.003017, "medianOperatingProfitMargin": -0.013476, "medianCostToChargeRatio": 0.577021, "medianCommercialMargin": 0.106803, "medianMedicareMargin": -0.00516, "medianMedicaidMargin": -0.335755, "totalNetRevenue": 12081063420.0, "medianLaborHourlyRate": 48.364634}, {"year": 2024, "state": "KY", "count": 91, "medianNetProfitMargin": 0.143542, "medianOperatingProfitMargin": 0.210696, "medianCostToChargeRatio": 0.269301, "medianCommercialMargin": 0.335, "medianMedicareMargin": 0.003204, "medianMedicaidMargin": 0.379901, "totalNetRevenue": 21565265931.0, "medianLaborHourlyRate": 47.801672}, {"year": 2024, "state": "LA", "count": 109, "medianNetProfitMargin": 0.077359, "medianOperatingProfitMargin": 0.08312, "medianCostToChargeRatio": 0.271188, "medianCommercialMargin": 0.157175, "medianMedicareMargin": -0.024434, "medianMedicaidMargin": 0.144203, "totalNetRevenue": 18515415734.0, "medianLaborHourlyRate": 43.103897}, {"year": 2024, "state": "MA", "count": 60, "medianNetProfitMargin": 0.009148, "medianOperatingProfitMargin": 0.041437, "medianCostToChargeRatio": 0.380686, "medianCommercialMargin": 0.154416, "medianMedicareMargin": -0.05945, "medianMedicaidMargin": -0.267144, "totalNetRevenue": 30564297940.0, "medianLaborHourlyRate": 62.730913}, {"year": 2024, "state": "MD", "count": 44, "medianNetProfitMargin": 0.026197, "medianOperatingProfitMargin": 0.176216, "medianCostToChargeRatio": 0.702711, "medianCommercialMargin": 0.183224, "medianMedicareMargin": 0.193709, "medianMedicaidMargin": 0.184168, "totalNetRevenue": 17486983091.0, "medianLaborHourlyRate": 54.167184}, {"year": 2024, "state": "ME", "count": 33, "medianNetProfitMargin": 0.019191, "medianOperatingProfitMargin": 0.137724, "medianCostToChargeRatio": 0.414376, "medianCommercialMargin": 0.334003, "medianMedicareMargin": -0.029826, "medianMedicaidMargin": 0.007101, "totalNetRevenue": 7528907229.0, "medianLaborHourlyRate": 48.649602}, {"year": 2024, "state": "MI", "count": 128, "medianNetProfitMargin": 0.066438, "medianOperatingProfitMargin": 0.182023, "medianCostToChargeRatio": 0.29757, "medianCommercialMargin": 0.294306, "medianMedicareMargin": 0.034986, "medianMedicaidMargin": 0.07937, "totalNetRevenue": 42254432840.0, "medianLaborHourlyRate": 49.420636}, {"year": 2024, "state": "MN", "count": 123, "medianNetProfitMargin": 0.052497, "medianOperatingProfitMargin": 0.153295, "medianCostToChargeRatio": 0.480459, "medianCommercialMargin": 0.358094, "medianMedicareMargin": -0.006193, "medianMedicaidMargin": -0.34474, "totalNetRevenue": 25684473160.0, "medianLaborHourlyRate": 63.862058}, {"year": 2024, "state": "MO", "count": 99, "medianNetProfitMargin": 0.027043, "medianOperatingProfitMargin": 0.12637, "medianCostToChargeRatio": 0.259415, "medianCommercialMargin": 0.332375, "medianMedicareMargin": -0.000319, "medianMedicaidMargin": 0.042362, "totalNetRevenue": 28092443583.0, "medianLaborHourlyRate": 52.817683}, {"year": 2024, "state": "MS", "count": 92, "medianNetProfitMargin": 0.033413, "medianOperatingProfitMargin": 0.070371, "medianCostToChargeRatio": 0.353957, "medianCommercialMargin": 0.12406, "medianMedicareMargin": 0.00308, "medianMedicaidMargin": 0.458998, "totalNetRevenue": 10049976640.0, "medianLaborHourlyRate": 43.206756}, {"year": 2024, "state": "MT", "count": 61, "medianNetProfitMargin": 0.038714, "medianOperatingProfitMargin": 0.037549, "medianCostToChargeRatio": 0.70463, "medianCommercialMargin": 0.193205, "medianMedicareMargin": -0.007962, "medianMedicaidMargin": 0.112351, "totalNetRevenue": 6028792233.0, "medianLaborHourlyRate": 53.782386}, {"year": 2024, "state": "NC", "count": 101, "medianNetProfitMargin": 0.097803, "medianOperatingProfitMargin": 0.240074, "medianCostToChargeRatio": 0.236657, "medianCommercialMargin": 0.475842, "medianMedicareMargin": -0.013483, "medianMedicaidMargin": 0.280803, "totalNetRevenue": 46603548344.0, "medianLaborHourlyRate": 53.361147}, {"year": 2024, "state": "ND", "count": 44, "medianNetProfitMargin": 0.038296, "medianOperatingProfitMargin": 0.012613, "medianCostToChargeRatio": 0.723289, "medianCommercialMargin": 0.125592, "medianMedicareMargin": -0.002276, "medianMedicaidMargin": -0.190028, "totalNetRevenue": 5233691976.0, "medianLaborHourlyRate": 49.202525}, {"year": 2024, "state": "NE", "count": 88, "medianNetProfitMargin": 0.042993, "medianOperatingProfitMargin": 0.052714, "medianCostToChargeRatio": 0.673634, "medianCommercialMargin": 0.208808, "medianMedicareMargin": -0.004616, "medianMedicaidMargin": -0.278879, "totalNetRevenue": 8358247839.0, "medianLaborHourlyRate": 59.520862}, {"year": 2024, "state": "NH", "count": 26, "medianNetProfitMargin": 0.124333, "medianOperatingProfitMargin": 0.1314, "medianCostToChargeRatio": 0.315504, "medianCommercialMargin": 0.349361, "medianMedicareMargin": -0.024862, "medianMedicaidMargin": -0.094692, "totalNetRevenue": 6953450491.0, "medianLaborHourlyRate": 57.907074}, {"year": 2024, "state": "NJ", "count": 61, "medianNetProfitMargin": 0.038836, "medianOperatingProfitMargin": 0.144814, "medianCostToChargeRatio": 0.175497, "medianCommercialMargin": 0.466514, "medianMedicareMargin": -0.102454, "medianMedicaidMargin": -0.117022, "totalNetRevenue": 35236384289.0, "medianLaborHourlyRate": 59.414036}, {"year": 2024, "state": "NM", "count": 40, "medianNetProfitMargin": 0.071348, "medianOperatingProfitMargin": 0.225203, "medianCostToChargeRatio": 0.321973, "medianCommercialMargin": 0.548287, "medianMedicareMargin": -0.023385, "medianMedicaidMargin": -0.098948, "totalNetRevenue": 7467549418.0, "medianLaborHourlyRate": 51.125373}, {"year": 2024, "state": "NV", "count": 34, "medianNetProfitMargin": 0.117582, "medianOperatingProfitMargin": 0.159649, "medianCostToChargeRatio": 0.195863, "medianCommercialMargin": 0.375788, "medianMedicareMargin": 0.013903, "medianMedicaidMargin": -0.168406, "totalNetRevenue": 9190015779.0, "medianLaborHourlyRate": 61.456429}, {"year": 2024, "state": "NY", "count": 153, "medianNetProfitMargin": 0.030173, "medianOperatingProfitMargin": 0.084339, "medianCostToChargeRatio": 0.33188, "medianCommercialMargin": 0.342257, "medianMedicareMargin": -0.030985, "medianMedicaidMargin": -0.383359, "totalNetRevenue": 105955787829.0, "medianLaborHourlyRate": 67.290165}, {"year": 2024, "state": "OH", "count": 149, "medianNetProfitMargin": 0.059183, "medianOperatingProfitMargin": 0.182539, "medianCostToChargeRatio": 0.236622, "medianCommercialMargin": 0.437963, "medianMedicareMargin": 0.007723, "medianMedicaidMargin": -0.275288, "totalNetRevenue": 54720511669.0, "medianLaborHourlyRate": 50.729394}, {"year": 2024, "state": "OK", "count": 118, "medianNetProfitMargin": 0.029961, "medianOperatingProfitMargin": 0.039663, "medianCostToChargeRatio": 0.274375, "medianCommercialMargin": 0.260078, "medianMedicareMargin": 0.004936, "medianMedicaidMargin": -0.02322, "totalNetRevenue": 14452456305.0, "medianLaborHourlyRate": 47.852572}, {"year": 2024, "state": "OR", "count": 57, "medianNetProfitMargin": 0.035238, "medianOperatingProfitMargin": 0.165895, "medianCostToChargeRatio": 0.376986, "medianCommercialMargin": 0.50227, "medianMedicareMargin": -0.056694, "medianMedicaidMargin": -0.183471, "totalNetRevenue": 17241061663.0, "medianLaborHourlyRate": 69.084133}, {"year": 2024, "state": "PA", "count": 150, "medianNetProfitMargin": 0.045383, "medianOperatingProfitMargin": 0.160576, "medianCostToChargeRatio": 0.201777, "medianCommercialMargin": 0.314075, "medianMedicareMargin": 0.005782, "medianMedicaidMargin": -0.248008, "totalNetRevenue": 56973135658.0, "medianLaborHourlyRate": 51.141611}, {"year": 2024, "state": "RI", "count": 10, "medianNetProfitMargin": 0.040027, "medianOperatingProfitMargin": 0.056187, "medianCostToChargeRatio": 0.27963, "medianCommercialMargin": 0.133406, "medianMedicareMargin": -0.053782, "medianMedicaidMargin": -0.155672, "totalNetRevenue": 4174055786.0, "medianLaborHourlyRate": 55.994599}, {"year": 2024, "state": "SC", "count": 53, "medianNetProfitMargin": 0.121944, "medianOperatingProfitMargin": 0.224704, "medianCostToChargeRatio": 0.191735, "medianCommercialMargin": 0.457054, "medianMedicareMargin": -0.039791, "medianMedicaidMargin": 0.318037, "totalNetRevenue": 21222013534.0, "medianLaborHourlyRate": 49.993436}, {"year": 2024, "state": "SD", "count": 58, "medianNetProfitMargin": 0.088945, "medianOperatingProfitMargin": 0.148925, "medianCostToChargeRatio": 0.433115, "medianCommercialMargin": 0.387842, "medianMedicareMargin": -0.000971, "medianMedicaidMargin": -0.055346, "totalNetRevenue": 6024862328.0, "medianLaborHourlyRate": 48.646101}, {"year": 2024, "state": "TN", "count": 98, "medianNetProfitMargin": 0.025167, "medianOperatingProfitMargin": 0.129282, "medianCostToChargeRatio": 0.192937, "medianCommercialMargin": 0.307169, "medianMedicareMargin": 0.075775, "medianMedicaidMargin": -0.103923, "totalNetRevenue": 26260005202.0, "medianLaborHourlyRate": 45.751358}, {"year": 2024, "state": "TX", "count": 365, "medianNetProfitMargin": 0.097783, "medianOperatingProfitMargin": 0.114406, "medianCostToChargeRatio": 0.205155, "medianCommercialMargin": 0.315508, "medianMedicareMargin": -0.006565, "medianMedicaidMargin": 0.303061, "totalNetRevenue": 93920080463.0, "medianLaborHourlyRate": 51.4038}, {"year": 2024, "state": "UT", "count": 46, "medianNetProfitMargin": 0.140115, "medianOperatingProfitMargin": 0.296225, "medianCostToChargeRatio": 0.277481, "medianCommercialMargin": 0.449596, "medianMedicareMargin": -0.023905, "medianMedicaidMargin": 0.335182, "totalNetRevenue": 12102754588.0, "medianLaborHourlyRate": 54.301087}, {"year": 2024, "state": "VA", "count": 80, "medianNetProfitMargin": 0.1074, "medianOperatingProfitMargin": 0.234109, "medianCostToChargeRatio": 0.215453, "medianCommercialMargin": 0.420054, "medianMedicareMargin": -0.057182, "medianMedicaidMargin": 0.290619, "totalNetRevenue": 33202544116.0, "medianLaborHourlyRate": 54.317904}, {"year": 2024, "state": "VT", "count": 14, "medianNetProfitMargin": 0.035149, "medianOperatingProfitMargin": 0.10161, "medianCostToChargeRatio": 0.404608, "medianCommercialMargin": 0.354977, "medianMedicareMargin": -0.008987, "medianMedicaidMargin": -0.619175, "totalNetRevenue": 3472196742.0, "medianLaborHourlyRate": 56.62757}, {"year": 2024, "state": "WA", "count": 86, "medianNetProfitMargin": 0.021757, "medianOperatingProfitMargin": 0.097707, "medianCostToChargeRatio": 0.321388, "medianCommercialMargin": 0.426466, "medianMedicareMargin": -0.023694, "medianMedicaidMargin": -0.177805, "totalNetRevenue": 29428328537.0, "medianLaborHourlyRate": 72.528559}, {"year": 2024, "state": "WI", "count": 125, "medianNetProfitMargin": 0.096307, "medianOperatingProfitMargin": 0.21032, "medianCostToChargeRatio": 0.342203, "medianCommercialMargin": 0.462737, "medianMedicareMargin": -0.000908, "medianMedicaidMargin": -0.585492, "totalNetRevenue": 25611326112.0, "medianLaborHourlyRate": 55.600234}, {"year": 2024, "state": "WV", "count": 47, "medianNetProfitMargin": 0.050182, "medianOperatingProfitMargin": 0.120389, "medianCostToChargeRatio": 0.322566, "medianCommercialMargin": 0.398594, "medianMedicareMargin": -0.008387, "medianMedicaidMargin": -0.157695, "totalNetRevenue": 10226276075.0, "medianLaborHourlyRate": 46.486621}, {"year": 2024, "state": "WY", "count": 27, "medianNetProfitMargin": -0.004466, "medianOperatingProfitMargin": 0.160073, "medianCostToChargeRatio": 0.576715, "medianCommercialMargin": 0.351791, "medianMedicareMargin": -0.00628, "medianMedicaidMargin": -0.257568, "totalNetRevenue": 2246004800.0, "medianLaborHourlyRate": 57.465793}], "yearFacility": [{"year": 2020, "facilityType": "Critical Access Hospitals", "count": 1352, "medianNetProfitMargin": 0.063108, "medianCostToChargeRatio": 0.583053, "medianCommercialMargin": 0.204327, "medianMedicareMargin": 0.006853, "medianMedicaidMargin": -0.277844}, {"year": 2020, "facilityType": "Short Term (General and Specialty) Hospitals", "count": 3185, "medianNetProfitMargin": 0.05694, "medianCostToChargeRatio": 0.239944, "medianCommercialMargin": 0.40805, "medianMedicareMargin": -0.053821, "medianMedicaidMargin": -0.22376}, {"year": 2021, "facilityType": "Critical Access Hospitals", "count": 1356, "medianNetProfitMargin": 0.158556, "medianCostToChargeRatio": 0.560574, "medianCommercialMargin": 0.239197, "medianMedicareMargin": 0.016694, "medianMedicaidMargin": -0.206142}, {"year": 2021, "facilityType": "Short Term (General and Specialty) Hospitals", "count": 3152, "medianNetProfitMargin": 0.099156, "medianCostToChargeRatio": 0.228261, "medianCommercialMargin": 0.423924, "medianMedicareMargin": -0.024997, "medianMedicaidMargin": -0.177313}, {"year": 2022, "facilityType": "Critical Access Hospitals", "count": 1359, "medianNetProfitMargin": 0.042767, "medianCostToChargeRatio": 0.560526, "medianCommercialMargin": 0.217295, "medianMedicareMargin": 0.012173, "medianMedicaidMargin": -0.192708}, {"year": 2022, "facilityType": "Short Term (General and Specialty) Hospitals", "count": 3146, "medianNetProfitMargin": 0.00901, "medianCostToChargeRatio": 0.23345, "medianCommercialMargin": 0.402652, "medianMedicareMargin": -0.070429, "medianMedicaidMargin": -0.216527}, {"year": 2023, "facilityType": "Critical Access Hospitals", "count": 1365, "medianNetProfitMargin": 0.042811, "medianCostToChargeRatio": 0.550887, "medianCommercialMargin": 0.211702, "medianMedicareMargin": 0.002424, "medianMedicaidMargin": -0.198478}, {"year": 2023, "facilityType": "Short Term (General and Specialty) Hospitals", "count": 3125, "medianNetProfitMargin": 0.035971, "medianCostToChargeRatio": 0.225395, "medianCommercialMargin": 0.404352, "medianMedicareMargin": -0.065481, "medianMedicaidMargin": -0.175999}, {"year": 2024, "facilityType": "Critical Access Hospitals", "count": 1370, "medianNetProfitMargin": 0.055935, "medianCostToChargeRatio": 0.530593, "medianCommercialMargin": 0.210387, "medianMedicareMargin": 0.002748, "medianMedicaidMargin": -0.100495}, {"year": 2024, "facilityType": "Short Term (General and Specialty) Hospitals", "count": 3098, "medianNetProfitMargin": 0.0563, "medianCostToChargeRatio": 0.217793, "medianCommercialMargin": 0.417485, "medianMedicareMargin": -0.053959, "medianMedicaidMargin": -0.073271}], "yearUrban": [{"year": 2020, "urbanRural": "Rural", "count": 2465, "medianNetProfitMargin": 0.060212, "medianCostToChargeRatio": 0.401719, "medianCommercialMargin": 0.316362, "medianMedicareMargin": 0.003865, "medianMedicaidMargin": -0.238275}, {"year": 2020, "urbanRural": "Urban", "count": 2069, "medianNetProfitMargin": 0.056177, "medianCostToChargeRatio": 0.232331, "medianCommercialMargin": 0.40011, "medianMedicareMargin": -0.054369, "medianMedicaidMargin": -0.241536}, {"year": 2021, "urbanRural": "Rural", "count": 2486, "medianNetProfitMargin": 0.131841, "medianCostToChargeRatio": 0.382431, "medianCommercialMargin": 0.335885, "medianMedicareMargin": 0.014338, "medianMedicaidMargin": -0.178693}, {"year": 2021, "urbanRural": "Urban", "count": 2021, "medianNetProfitMargin": 0.100438, "medianCostToChargeRatio": 0.219397, "medianCommercialMargin": 0.423307, "medianMedicareMargin": -0.024061, "medianMedicaidMargin": -0.197746}, {"year": 2022, "urbanRural": "Rural", "count": 2516, "medianNetProfitMargin": 0.02218, "medianCostToChargeRatio": 0.383152, "medianCommercialMargin": 0.310683, "medianMedicareMargin": 0.007018, "medianMedicaidMargin": -0.196755}, {"year": 2022, "urbanRural": "Urban", "count": 1985, "medianNetProfitMargin": 0.018369, "medianCostToChargeRatio": 0.222509, "medianCommercialMargin": 0.402256, "medianMedicareMargin": -0.065382, "medianMedicaidMargin": -0.223218}, {"year": 2023, "urbanRural": "Rural", "count": 2580, "medianNetProfitMargin": 0.03229, "medianCostToChargeRatio": 0.370104, "medianCommercialMargin": 0.30945, "medianMedicareMargin": -0.002483, "medianMedicaidMargin": -0.177485}, {"year": 2023, "urbanRural": "Urban", "count": 1906, "medianNetProfitMargin": 0.047557, "medianCostToChargeRatio": 0.214973, "medianCommercialMargin": 0.407137, "medianMedicareMargin": -0.057939, "medianMedicaidMargin": -0.195368}, {"year": 2024, "urbanRural": "Rural", "count": 2627, "medianNetProfitMargin": 0.053248, "medianCostToChargeRatio": 0.350783, "medianCommercialMargin": 0.315508, "medianMedicareMargin": -0.001147, "medianMedicaidMargin": -0.083302}, {"year": 2024, "urbanRural": "Urban", "count": 1833, "medianNetProfitMargin": 0.060781, "medianCostToChargeRatio": 0.208142, "medianCommercialMargin": 0.40786, "medianMedicareMargin": -0.053819, "medianMedicaidMargin": -0.089532}], "stateSummary": [{"state": "AK", "count": 21, "medianNetProfitMargin": 0.078771, "medianCostToChargeRatio": 0.545303, "medianCommercialMargin": 0.528058, "medianMedicareMargin": -0.012195, "medianMedicaidMargin": -0.064804, "pctPositiveMargin": 68.8}, {"state": "AL", "count": 85, "medianNetProfitMargin": 0.001951, "medianCostToChargeRatio": 0.269614, "medianCommercialMargin": 0.030534, "medianMedicareMargin": 0.076823, "medianMedicaidMargin": 0.266776, "pctPositiveMargin": 50.0}, {"state": "AR", "count": 75, "medianNetProfitMargin": 0.004674, "medianCostToChargeRatio": 0.292599, "medianCommercialMargin": 0.168971, "medianMedicareMargin": 0.014999, "medianMedicaidMargin": -0.088748, "pctPositiveMargin": 52.0}, {"state": "AZ", "count": 82, "medianNetProfitMargin": 0.106802, "medianCostToChargeRatio": 0.188756, "medianCommercialMargin": 0.45414, "medianMedicareMargin": -0.007921, "medianMedicaidMargin": -0.097544, "pctPositiveMargin": 86.1}, {"state": "CA", "count": 316, "medianNetProfitMargin": 0.038777, "medianCostToChargeRatio": 0.200958, "medianCommercialMargin": 0.469928, "medianMedicareMargin": -0.072463, "medianMedicaidMargin": -0.245426, "pctPositiveMargin": 66.5}, {"state": "CO", "count": 83, "medianNetProfitMargin": 0.04856, "medianCostToChargeRatio": 0.277965, "medianCommercialMargin": 0.443549, "medianMedicareMargin": -0.026124, "medianMedicaidMargin": -0.29706, "pctPositiveMargin": 72.3}, {"state": "CT", "count": 26, "medianNetProfitMargin": 0.006396, "medianCostToChargeRatio": 0.26206, "medianCommercialMargin": 0.387859, "medianMedicareMargin": -0.031726, "medianMedicaidMargin": -0.380095, "pctPositiveMargin": 53.8}, {"state": "DC", "count": 6, "medianNetProfitMargin": 0.017048, "medianCostToChargeRatio": 0.270219, "medianCommercialMargin": 0.368848, "medianMedicareMargin": -0.113082, "medianMedicaidMargin": 0.086894, "pctPositiveMargin": 50.0}, {"state": "DE", "count": 6, "medianNetProfitMargin": 0.070944, "medianCostToChargeRatio": 0.290534, "medianCommercialMargin": 0.484541, "medianMedicareMargin": -0.141657, "medianMedicaidMargin": -0.208817, "pctPositiveMargin": 100.0}, {"state": "FL", "count": 180, "medianNetProfitMargin": 0.139328, "medianCostToChargeRatio": 0.142209, "medianCommercialMargin": 0.479656, "medianMedicareMargin": -0.02737, "medianMedicaidMargin": -0.493662, "pctPositiveMargin": 81.6}, {"state": "GA", "count": 127, "medianNetProfitMargin": 0.082048, "medianCostToChargeRatio": 0.216284, "medianCommercialMargin": 0.36904, "medianMedicareMargin": 0.013653, "medianMedicaidMargin": 0.191653, "pctPositiveMargin": 76.2}, {"state": "HI", "count": 21, "medianNetProfitMargin": 0.100108, "medianCostToChargeRatio": 0.430579, "medianCommercialMargin": 0.069719, "medianMedicareMargin": -0.006519, "medianMedicaidMargin": -0.269876, "pctPositiveMargin": 64.7}, {"state": "IA", "count": 112, "medianNetProfitMargin": 0.10959, "medianCostToChargeRatio": 0.512738, "medianCommercialMargin": 0.263098, "medianMedicareMargin": -0.004321, "medianMedicaidMargin": 0.270578, "pctPositiveMargin": 87.5}, {"state": "ID", "count": 43, "medianNetProfitMargin": 0.01918, "medianCostToChargeRatio": 0.53748, "medianCommercialMargin": 0.328885, "medianMedicareMargin": 0.000383, "medianMedicaidMargin": -0.132619, "pctPositiveMargin": 65.1}, {"state": "IL", "count": 170, "medianNetProfitMargin": 0.043683, "medianCostToChargeRatio": 0.237099, "medianCommercialMargin": 0.408982, "medianMedicareMargin": -0.015455, "medianMedicaidMargin": -0.19994, "pctPositiveMargin": 64.5}, {"state": "IN", "count": 115, "medianNetProfitMargin": 0.073424, "medianCostToChargeRatio": 0.223232, "medianCommercialMargin": 0.450112, "medianMedicareMargin": -0.071596, "medianMedicaidMargin": -0.274921, "pctPositiveMargin": 71.9}, {"state": "KS", "count": 130, "medianNetProfitMargin": -0.003017, "medianCostToChargeRatio": 0.577021, "medianCommercialMargin": 0.106803, "medianMedicareMargin": -0.00516, "medianMedicaidMargin": -0.335755, "pctPositiveMargin": 46.2}, {"state": "KY", "count": 91, "medianNetProfitMargin": 0.143542, "medianCostToChargeRatio": 0.269301, "medianCommercialMargin": 0.335, "medianMedicareMargin": 0.003204, "medianMedicaidMargin": 0.379901, "pctPositiveMargin": 92.2}, {"state": "LA", "count": 109, "medianNetProfitMargin": 0.077359, "medianCostToChargeRatio": 0.271188, "medianCommercialMargin": 0.157175, "medianMedicareMargin": -0.024434, "medianMedicaidMargin": 0.144203, "pctPositiveMargin": 75.9}, {"state": "MA", "count": 60, "medianNetProfitMargin": 0.009148, "medianCostToChargeRatio": 0.380686, "medianCommercialMargin": 0.154416, "medianMedicareMargin": -0.05945, "medianMedicaidMargin": -0.267144, "pctPositiveMargin": 56.1}, {"state": "MD", "count": 44, "medianNetProfitMargin": 0.026197, "medianCostToChargeRatio": 0.702711, "medianCommercialMargin": 0.183224, "medianMedicareMargin": 0.193709, "medianMedicaidMargin": 0.184168, "pctPositiveMargin": 70.5}, {"state": "ME", "count": 33, "medianNetProfitMargin": 0.019191, "medianCostToChargeRatio": 0.414376, "medianCommercialMargin": 0.334003, "medianMedicareMargin": -0.029826, "medianMedicaidMargin": 0.007101, "pctPositiveMargin": 54.5}, {"state": "MI", "count": 128, "medianNetProfitMargin": 0.066438, "medianCostToChargeRatio": 0.29757, "medianCommercialMargin": 0.294306, "medianMedicareMargin": 0.034986, "medianMedicaidMargin": 0.07937, "pctPositiveMargin": 75.4}, {"state": "MN", "count": 123, "medianNetProfitMargin": 0.052497, "medianCostToChargeRatio": 0.480459, "medianCommercialMargin": 0.358094, "medianMedicareMargin": -0.006193, "medianMedicaidMargin": -0.34474, "pctPositiveMargin": 73.6}, {"state": "MO", "count": 99, "medianNetProfitMargin": 0.027043, "medianCostToChargeRatio": 0.259415, "medianCommercialMargin": 0.332375, "medianMedicareMargin": -0.000319, "medianMedicaidMargin": 0.042362, "pctPositiveMargin": 59.6}, {"state": "MS", "count": 92, "medianNetProfitMargin": 0.033413, "medianCostToChargeRatio": 0.353957, "medianCommercialMargin": 0.12406, "medianMedicareMargin": 0.00308, "medianMedicaidMargin": 0.458998, "pctPositiveMargin": 66.3}, {"state": "MT", "count": 61, "medianNetProfitMargin": 0.038714, "medianCostToChargeRatio": 0.70463, "medianCommercialMargin": 0.193205, "medianMedicareMargin": -0.007962, "medianMedicaidMargin": 0.112351, "pctPositiveMargin": 63.8}, {"state": "NC", "count": 101, "medianNetProfitMargin": 0.097803, "medianCostToChargeRatio": 0.236657, "medianCommercialMargin": 0.475842, "medianMedicareMargin": -0.013483, "medianMedicaidMargin": 0.280803, "pctPositiveMargin": 84.0}, {"state": "ND", "count": 44, "medianNetProfitMargin": 0.038296, "medianCostToChargeRatio": 0.723289, "medianCommercialMargin": 0.125592, "medianMedicareMargin": -0.002276, "medianMedicaidMargin": -0.190028, "pctPositiveMargin": 64.3}, {"state": "NE", "count": 88, "medianNetProfitMargin": 0.042993, "medianCostToChargeRatio": 0.673634, "medianCommercialMargin": 0.208808, "medianMedicareMargin": -0.004616, "medianMedicaidMargin": -0.278879, "pctPositiveMargin": 65.1}, {"state": "NH", "count": 26, "medianNetProfitMargin": 0.124333, "medianCostToChargeRatio": 0.315504, "medianCommercialMargin": 0.349361, "medianMedicareMargin": -0.024862, "medianMedicaidMargin": -0.094692, "pctPositiveMargin": 76.9}, {"state": "NJ", "count": 61, "medianNetProfitMargin": 0.038836, "medianCostToChargeRatio": 0.175497, "medianCommercialMargin": 0.466514, "medianMedicareMargin": -0.102454, "medianMedicaidMargin": -0.117022, "pctPositiveMargin": 73.8}, {"state": "NM", "count": 40, "medianNetProfitMargin": 0.071348, "medianCostToChargeRatio": 0.321973, "medianCommercialMargin": 0.548287, "medianMedicareMargin": -0.023385, "medianMedicaidMargin": -0.098948, "pctPositiveMargin": 82.9}, {"state": "NV", "count": 34, "medianNetProfitMargin": 0.117582, "medianCostToChargeRatio": 0.195863, "medianCommercialMargin": 0.375788, "medianMedicareMargin": 0.013903, "medianMedicaidMargin": -0.168406, "pctPositiveMargin": 70.6}, {"state": "NY", "count": 153, "medianNetProfitMargin": 0.030173, "medianCostToChargeRatio": 0.33188, "medianCommercialMargin": 0.342257, "medianMedicareMargin": -0.030985, "medianMedicaidMargin": -0.383359, "pctPositiveMargin": 61.2}, {"state": "OH", "count": 149, "medianNetProfitMargin": 0.059183, "medianCostToChargeRatio": 0.236622, "medianCommercialMargin": 0.437963, "medianMedicareMargin": 0.007723, "medianMedicaidMargin": -0.275288, "pctPositiveMargin": 73.2}, {"state": "OK", "count": 118, "medianNetProfitMargin": 0.029961, "medianCostToChargeRatio": 0.274375, "medianCommercialMargin": 0.260078, "medianMedicareMargin": 0.004936, "medianMedicaidMargin": -0.02322, "pctPositiveMargin": 66.1}, {"state": "OR", "count": 57, "medianNetProfitMargin": 0.035238, "medianCostToChargeRatio": 0.376986, "medianCommercialMargin": 0.50227, "medianMedicareMargin": -0.056694, "medianMedicaidMargin": -0.183471, "pctPositiveMargin": 61.8}, {"state": "PA", "count": 150, "medianNetProfitMargin": 0.045383, "medianCostToChargeRatio": 0.201777, "medianCommercialMargin": 0.314075, "medianMedicareMargin": 0.005782, "medianMedicaidMargin": -0.248008, "pctPositiveMargin": 65.3}, {"state": "RI", "count": 10, "medianNetProfitMargin": 0.040027, "medianCostToChargeRatio": 0.27963, "medianCommercialMargin": 0.133406, "medianMedicareMargin": -0.053782, "medianMedicaidMargin": -0.155672, "pctPositiveMargin": 60.0}, {"state": "SC", "count": 53, "medianNetProfitMargin": 0.121944, "medianCostToChargeRatio": 0.191735, "medianCommercialMargin": 0.457054, "medianMedicareMargin": -0.039791, "medianMedicaidMargin": 0.318037, "pctPositiveMargin": 84.9}, {"state": "SD", "count": 58, "medianNetProfitMargin": 0.088945, "medianCostToChargeRatio": 0.433115, "medianCommercialMargin": 0.387842, "medianMedicareMargin": -0.000971, "medianMedicaidMargin": -0.055346, "pctPositiveMargin": 80.0}, {"state": "TN", "count": 98, "medianNetProfitMargin": 0.025167, "medianCostToChargeRatio": 0.192937, "medianCommercialMargin": 0.307169, "medianMedicareMargin": 0.075775, "medianMedicaidMargin": -0.103923, "pctPositiveMargin": 58.8}, {"state": "TX", "count": 365, "medianNetProfitMargin": 0.097783, "medianCostToChargeRatio": 0.205155, "medianCommercialMargin": 0.315508, "medianMedicareMargin": -0.006565, "medianMedicaidMargin": 0.303061, "pctPositiveMargin": 70.9}, {"state": "UT", "count": 46, "medianNetProfitMargin": 0.140115, "medianCostToChargeRatio": 0.277481, "medianCommercialMargin": 0.449596, "medianMedicareMargin": -0.023905, "medianMedicaidMargin": 0.335182, "pctPositiveMargin": 91.3}, {"state": "VA", "count": 80, "medianNetProfitMargin": 0.1074, "medianCostToChargeRatio": 0.215453, "medianCommercialMargin": 0.420054, "medianMedicareMargin": -0.057182, "medianMedicaidMargin": 0.290619, "pctPositiveMargin": 73.8}, {"state": "VT", "count": 14, "medianNetProfitMargin": 0.035149, "medianCostToChargeRatio": 0.404608, "medianCommercialMargin": 0.354977, "medianMedicareMargin": -0.008987, "medianMedicaidMargin": -0.619175, "pctPositiveMargin": 64.3}, {"state": "WA", "count": 86, "medianNetProfitMargin": 0.021757, "medianCostToChargeRatio": 0.321388, "medianCommercialMargin": 0.426466, "medianMedicareMargin": -0.023694, "medianMedicaidMargin": -0.177805, "pctPositiveMargin": 64.3}, {"state": "WI", "count": 125, "medianNetProfitMargin": 0.096307, "medianCostToChargeRatio": 0.342203, "medianCommercialMargin": 0.462737, "medianMedicareMargin": -0.000908, "medianMedicaidMargin": -0.585492, "pctPositiveMargin": 76.7}, {"state": "WV", "count": 47, "medianNetProfitMargin": 0.050182, "medianCostToChargeRatio": 0.322566, "medianCommercialMargin": 0.398594, "medianMedicareMargin": -0.008387, "medianMedicaidMargin": -0.157695, "pctPositiveMargin": 76.1}, {"state": "WY", "count": 27, "medianNetProfitMargin": -0.004466, "medianCostToChargeRatio": 0.576715, "medianCommercialMargin": 0.351791, "medianMedicareMargin": -0.00628, "medianMedicaidMargin": -0.257568, "pctPositiveMargin": 48.1}], "meta": {"years": [2020, 2021, 2022, 2023, 2024], "states": ["AK", "AL", "AR", "AZ", "CA", "CO", "CT", "DC", "DE", "FL", "GA", "HI", "IA", "ID", "IL", "IN", "KS", "KY", "LA", "MA", "MD", "ME", "MI", "MN", "MO", "MS", "MT", "NC", "ND", "NE", "NH", "NJ", "NM", "NV", "NY", "OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX", "UT", "VA", "VT", "WA", "WI", "WV", "WY"], "ownershipTypes": ["For-Profit", "Governmental", "Non-Profit"], "facilityTypes": ["Critical Access Hospitals", "Short Term (General and Specialty) Hospitals"], "latestYear": 2024, "totalRecords": 22508}};

const OWNER_COLORS = ['#3b82f6', '#f59e0b', '#10b981'];
const OWNER_ORDER = ['Non-Profit', 'For-Profit', 'Governmental'];
const PAYER_COLORS = { Commercial: '#3b82f6', Medicare: '#f59e0b', Medicaid: '#10b981' };

function fmt(val, type) {
    if (val == null || isNaN(val)) return '\u2014';
    switch(type) {
        case 'pct': return (val * 100).toFixed(1) + '%';
        case 'pct1': return val.toFixed(1) + '%';
        case 'currency':
            if (Math.abs(val) >= 1e12) return '$' + (val/1e12).toFixed(2) + 'T';
            if (Math.abs(val) >= 1e9) return '$' + (val/1e9).toFixed(1) + 'B';
            if (Math.abs(val) >= 1e6) return '$' + (val/1e6).toFixed(1) + 'M';
            if (Math.abs(val) >= 1e3) return '$' + (val/1e3).toFixed(1) + 'K';
            return '$' + val.toFixed(0);
        case 'currencyShort':
            if (Math.abs(val) >= 1e12) return '$' + (val/1e12).toFixed(1) + 'T';
            if (Math.abs(val) >= 1e9) return '$' + (val/1e9).toFixed(0) + 'B';
            return '$' + (val/1e6).toFixed(0) + 'M';
        case 'number': return val.toLocaleString();
        case 'rate': return '$' + val.toFixed(2);
        case 'ratio': return val.toFixed(3);
        default: return String(val);
    }
}

function changeTag(current, previous, type) {
    if (current == null || previous == null) return '';
    let diff, cls, arrow, sign, text;
    if (type === 'pct') {
        diff = (current - previous) * 100;
        sign = diff >= 0 ? '+' : '';
        cls = diff >= 0 ? 'positive' : 'negative';
        arrow = diff >= 0 ? '\u2191' : '\u2193';
        text = sign + diff.toFixed(1) + 'pp vs prior year';
    } else {
        diff = previous !== 0 ? ((current - previous) / Math.abs(previous)) * 100 : 0;
        sign = diff >= 0 ? '+' : '';
        cls = diff >= 0 ? 'positive' : 'negative';
        arrow = diff >= 0 ? '\u2191' : '\u2193';
        text = sign + diff.toFixed(1) + '% vs prior year';
    }
    return '<span class="kpi-change ' + cls + '">' + arrow + ' ' + text + '</span>';
}

class Dashboard {
    constructor(data) {
        this.data = data;
        this.charts = {};
        this.sortCol = 'medianNetProfitMargin';
        this.sortDir = 'desc';
        this.init();
    }

    init() {
        this.populateFilters();
        this.applyFilters();
    }

    populateFilters() {
        var m = this.data.meta;
        function addOpts(id, vals, labels) {
            var sel = document.getElementById(id);
            for (var i = 0; i < vals.length; i++) {
                var o = document.createElement('option');
                o.value = vals[i];
                o.textContent = labels ? labels[i] : vals[i];
                sel.appendChild(o);
            }
        }
        addOpts('filter-year', m.years);
        addOpts('filter-state', m.states);
        addOpts('filter-ownership', m.ownershipTypes);
        var facLabels = m.facilityTypes.map(function(f) {
            return f.replace(' Hospitals','').replace('Short Term (General and Specialty)','Short Term');
        });
        addOpts('filter-facility', m.facilityTypes, facLabels);
        addOpts('filter-urban', ['Urban', 'Rural']);
    }

    getFilters() {
        return {
            year: document.getElementById('filter-year').value,
            state: document.getElementById('filter-state').value,
            ownership: document.getElementById('filter-ownership').value,
            facility: document.getElementById('filter-facility').value,
            urban: document.getElementById('filter-urban').value,
        };
    }

    applyFilters() {
        var f = this.getFilters();
        this.renderKPIs(f);
        this.renderMarginTrend(f);
        this.renderPayerMargins(f);
        this.renderOwnershipMix(f);
        this.renderLaborRate(f);
        this.renderStateRank(f);
        this.renderTable(f);
    }

    getYearlyData(f) {
        if (f.state !== 'all') {
            return this.data.yearState.filter(function(r) { return r.state === f.state; });
        }
        return this.data.yearly;
    }

    renderKPIs(f) {
        var yearlyData = this.getYearlyData(f);
        var years = f.year !== 'all' ? [parseInt(f.year)] : this.data.meta.years;
        var latestYear = Math.max.apply(null, years);
        var prevYear = latestYear - 1;
        var latest = yearlyData.find(function(r) { return r.year === latestYear; });
        var prev = yearlyData.find(function(r) { return r.year === prevYear; });

        if (!latest) {
            ['kpi-count','kpi-margin','kpi-profitable','kpi-revenue','kpi-ctc','kpi-covid'].forEach(function(id) {
                document.getElementById(id).textContent = '\u2014';
            });
            return;
        }

        document.getElementById('kpi-count').textContent = fmt(latest.count, 'number');
        document.getElementById('kpi-count-sub').textContent = latestYear + ' reporting period';
        document.getElementById('kpi-margin').textContent = fmt(latest.medianNetProfitMargin, 'pct');
        document.getElementById('kpi-margin-change').innerHTML = prev ? changeTag(latest.medianNetProfitMargin, prev.medianNetProfitMargin, 'pct') : '';
        document.getElementById('kpi-profitable').textContent = latest.pctPositiveMargin != null ? latest.pctPositiveMargin + '%' : '\u2014';
        document.getElementById('kpi-profitable-change').innerHTML = prev && prev.pctPositiveMargin != null ? changeTag(latest.pctPositiveMargin, prev.pctPositiveMargin, 'abs') : '';
        document.getElementById('kpi-revenue').textContent = fmt(latest.totalNetRevenue, 'currencyShort');
        document.getElementById('kpi-revenue-change').innerHTML = prev ? changeTag(latest.totalNetRevenue, prev.totalNetRevenue, 'abs') : '';
        document.getElementById('kpi-ctc').textContent = fmt(latest.medianCostToChargeRatio, 'ratio');
        document.getElementById('kpi-covid').textContent = fmt(latest.totalCovidFunding, 'currencyShort');
        document.getElementById('kpi-covid-change').innerHTML = prev && prev.totalCovidFunding ? changeTag(latest.totalCovidFunding, prev.totalCovidFunding, 'abs') : '';
    }

    renderMarginTrend(f) {
        var years = this.data.meta.years;
        var self = this;
        var datasets = OWNER_ORDER.map(function(own, i) {
            var src = self.data.yearOwnership.filter(function(r) { return r.ownership === own; });
            return {
                label: own,
                data: years.map(function(y) { var r = src.find(function(d) { return d.year === y; }); return r ? +(r.medianNetProfitMargin * 100).toFixed(2) : null; }),
                borderColor: OWNER_COLORS[i],
                backgroundColor: OWNER_COLORS[i] + '18',
                borderWidth: 2.5, fill: false, tension: 0.3, pointRadius: 4, pointHoverRadius: 7, pointBackgroundColor: OWNER_COLORS[i],
            };
        });

        var overallSrc = f.state !== 'all' ? this.data.yearState.filter(function(r) { return r.state === f.state; }) : this.data.yearly;
        datasets.unshift({
            label: 'Overall',
            data: years.map(function(y) { var r = overallSrc.find(function(d) { return d.year === y; }); return r ? +(r.medianNetProfitMargin * 100).toFixed(2) : null; }),
            borderColor: '#1e293b', backgroundColor: '#1e293b18', borderWidth: 3, borderDash: [6, 3],
            fill: false, tension: 0.3, pointRadius: 5, pointHoverRadius: 8, pointBackgroundColor: '#1e293b',
        });

        this.createChart('chart-margin-trend', 'line', years, datasets, {
            scales: {
                y: { ticks: { callback: function(v) { return v.toFixed(0) + '%'; } }, title: { display: true, text: 'Median Net Profit Margin (%)' }, grid: { color: '#f1f5f9' } },
                x: { grid: { display: false } }
            },
            plugins: { tooltip: { callbacks: { label: function(ctx) { return ctx.dataset.label + ': ' + ctx.parsed.y.toFixed(1) + '%'; } } } }
        });
    }

    renderPayerMargins(f) {
        var years = this.data.meta.years;
        var src = f.state !== 'all' ? this.data.yearState.filter(function(r) { return r.state === f.state; }) : this.data.yearly;
        var payers = [
            { key: 'medianCommercialMargin', label: 'Commercial', color: PAYER_COLORS.Commercial },
            { key: 'medianMedicareMargin', label: 'Medicare', color: PAYER_COLORS.Medicare },
            { key: 'medianMedicaidMargin', label: 'Medicaid', color: PAYER_COLORS.Medicaid },
        ];
        var datasets = payers.map(function(p) {
            return {
                label: p.label,
                data: years.map(function(y) { var r = src.find(function(d) { return d.year === y; }); return r && r[p.key] != null ? +(r[p.key] * 100).toFixed(2) : null; }),
                backgroundColor: p.color + 'CC', borderColor: p.color, borderWidth: 1, borderRadius: 4,
            };
        });

        this.createChart('chart-payer-margins', 'bar', years, datasets, {
            scales: {
                y: { ticks: { callback: function(v) { return v.toFixed(0) + '%'; } }, title: { display: true, text: 'Median Operating Profit Margin (%)' }, grid: { color: '#f1f5f9' } },
                x: { grid: { display: false } }
            },
            plugins: { tooltip: { callbacks: { label: function(ctx) { return ctx.dataset.label + ': ' + ctx.parsed.y.toFixed(1) + '%'; } } } }
        });
    }

    renderOwnershipMix(f) {
        var years = this.data.meta.years;
        var src = this.data.yearOwnership;
        var datasets = OWNER_ORDER.map(function(own, i) {
            return {
                label: own,
                data: years.map(function(y) { var r = src.find(function(d) { return d.year === y && d.ownership === own; }); return r ? r.count : 0; }),
                backgroundColor: OWNER_COLORS[i] + 'CC', borderColor: OWNER_COLORS[i], borderWidth: 1, borderRadius: 4,
            };
        });

        this.createChart('chart-ownership-mix', 'bar', years, datasets, {
            scales: {
                y: { stacked: true, ticks: { callback: function(v) { return v.toLocaleString(); } }, title: { display: true, text: 'Number of Hospitals' }, grid: { color: '#f1f5f9' } },
                x: { stacked: true, grid: { display: false } }
            },
            plugins: { tooltip: { callbacks: { label: function(ctx) { return ctx.dataset.label + ': ' + ctx.parsed.y.toLocaleString() + ' hospitals'; } } } }
        });
    }

    renderLaborRate(f) {
        var years = this.data.meta.years;
        var self = this;
        var datasets = OWNER_ORDER.map(function(own, i) {
            var src = self.data.yearOwnership.filter(function(r) { return r.ownership === own; });
            return {
                label: own,
                data: years.map(function(y) { var r = src.find(function(d) { return d.year === y; }); return r && r.medianLaborHourlyRate ? +r.medianLaborHourlyRate.toFixed(2) : null; }),
                borderColor: OWNER_COLORS[i], backgroundColor: OWNER_COLORS[i] + '18', borderWidth: 2.5,
                fill: false, tension: 0.3, pointRadius: 4, pointHoverRadius: 7, pointBackgroundColor: OWNER_COLORS[i],
            };
        });

        this.createChart('chart-labor-rate', 'line', years, datasets, {
            scales: {
                y: { ticks: { callback: function(v) { return '$' + v.toFixed(0); } }, title: { display: true, text: 'Median Hourly Rate ($)' }, grid: { color: '#f1f5f9' } },
                x: { grid: { display: false } }
            },
            plugins: { tooltip: { callbacks: { label: function(ctx) { return ctx.dataset.label + ': $' + ctx.parsed.y.toFixed(2) + '/hr'; } } } }
        });
    }

    renderStateRank(f) {
        var selectedYear = f.year !== 'all' ? parseInt(f.year) : this.data.meta.latestYear;
        document.getElementById('state-chart-title').textContent = 'State Profitability Ranking (' + selectedYear + ')';

        var stateData;
        if (selectedYear === this.data.meta.latestYear && f.state === 'all') {
            stateData = this.data.stateSummary.slice();
        } else {
            stateData = this.data.yearState.filter(function(r) { return r.year === selectedYear; });
        }
        if (f.state !== 'all') {
            stateData = stateData.filter(function(r) { return r.state === f.state; });
        }

        stateData = stateData.filter(function(r) { return r.medianNetProfitMargin != null; });
        stateData.sort(function(a, b) { return b.medianNetProfitMargin - a.medianNetProfitMargin; });

        var labels = stateData.map(function(r) { return r.state; });
        var values = stateData.map(function(r) { return +(r.medianNetProfitMargin * 100).toFixed(2); });
        var bgColors = values.map(function(v) { return v >= 0 ? '#10b981CC' : '#ef4444CC'; });
        var borderColors = values.map(function(v) { return v >= 0 ? '#10b981' : '#ef4444'; });

        var chartHeight = labels.length > 10 ? Math.max(400, labels.length * 22) : 320;
        this.createChart('chart-state-rank', 'bar', labels, [{
            label: 'Median Net Profit Margin',
            data: values, backgroundColor: bgColors, borderColor: borderColors, borderWidth: 1, borderRadius: 3,
        }], {
            indexAxis: 'y',
            scales: {
                x: { ticks: { callback: function(v) { return v.toFixed(0) + '%'; } }, grid: { color: '#f1f5f9' } },
                y: { grid: { display: false }, ticks: { font: { size: 11 } } }
            },
            plugins: { legend: { display: false }, tooltip: { callbacks: { label: function(ctx) { return ctx.parsed.x.toFixed(1) + '% median net profit margin'; } } } },
        }, chartHeight);
    }

    renderTable(f) {
        var selectedYear = f.year !== 'all' ? parseInt(f.year) : this.data.meta.latestYear;
        var rows;
        if (selectedYear === this.data.meta.latestYear && f.state === 'all') {
            rows = this.data.stateSummary.slice();
        } else {
            rows = this.data.yearState.filter(function(r) { return r.year === selectedYear; });
        }
        if (f.state !== 'all') rows = rows.filter(function(r) { return r.state === f.state; });

        var sortCol = this.sortCol, sortDir = this.sortDir;
        rows.sort(function(a, b) {
            var av = a[sortCol], bv = b[sortCol];
            if (av == null) av = -Infinity;
            if (bv == null) bv = -Infinity;
            return sortDir === 'asc' ? (av > bv ? 1 : -1) : (av < bv ? 1 : -1);
        });

        var cols = [
            { key: 'state', label: 'State', fmt: null },
            { key: 'count', label: 'Hospitals', fmt: 'number' },
            { key: 'medianNetProfitMargin', label: 'Net Profit Margin', fmt: 'pct', hl: true },
            { key: 'medianCostToChargeRatio', label: 'Cost-to-Charge', fmt: 'ratio' },
            { key: 'medianCommercialMargin', label: 'Commercial Margin', fmt: 'pct', hl: true },
            { key: 'medianMedicareMargin', label: 'Medicare Margin', fmt: 'pct', hl: true },
            { key: 'medianMedicaidMargin', label: 'Medicaid Margin', fmt: 'pct', hl: true },
        ];

        var html = '<table class="data-table"><thead><tr>';
        var self = this;
        cols.forEach(function(c) {
            var sorted = sortCol === c.key;
            var arrow = sorted ? (sortDir === 'asc' ? '\u25B2' : '\u25BC') : '\u21C5';
            html += '<th class="' + (sorted ? 'sorted' : '') + '" onclick="dashboard.sortTable(\'' + c.key + '\')">' + c.label + ' <span class="sort-arrow">' + arrow + '</span></th>';
        });
        html += '</tr></thead><tbody>';

        rows.forEach(function(row) {
            html += '<tr>';
            cols.forEach(function(c) {
                var val = row[c.key];
                var display = c.fmt ? fmt(val, c.fmt) : val;
                var cls = c.fmt && c.key !== 'state' && c.key !== 'count' ? 'num' : '';
                if (c.hl && val != null) cls += val > 0 ? ' positive-val' : val < 0 ? ' negative-val' : '';
                html += '<td class="' + cls + '">' + display + '</td>';
            });
            html += '</tr>';
        });
        html += '</tbody></table>';

        document.getElementById('table-container').innerHTML = html;
        document.getElementById('table-count').textContent = rows.length + ' states \u00B7 ' + selectedYear;
    }

    sortTable(col) {
        if (this.sortCol === col) {
            this.sortDir = this.sortDir === 'asc' ? 'desc' : 'asc';
        } else {
            this.sortCol = col;
            this.sortDir = 'desc';
        }
        this.renderTable(this.getFilters());
    }

    createChart(canvasId, type, labels, datasets, options, height) {
        if (this.charts[canvasId]) this.charts[canvasId].destroy();
        var canvas = document.getElementById(canvasId);
        if (height) {
            canvas.parentElement.style.height = height + 'px';
            canvas.style.maxHeight = height + 'px';
        } else {
            canvas.parentElement.style.height = '';
            canvas.style.maxHeight = '320px';
        }
        var chartOpts = {
            responsive: true,
            maintainAspectRatio: !height,
            animation: { duration: 400 },
            interaction: { mode: 'index', intersect: false },
            plugins: Object.assign({
                legend: { position: 'top', labels: { usePointStyle: true, padding: 16, font: { size: 12 } } }
            }, options.plugins || {}),
            scales: options.scales || {},
        };
        if (options.indexAxis) chartOpts.indexAxis = options.indexAxis;
        this.charts[canvasId] = new Chart(canvas.getContext('2d'), { type: type, data: { labels: labels, datasets: datasets }, options: chartOpts });
    }
}

var dashboard = new Dashboard(D);

</script>
</body>
</html>